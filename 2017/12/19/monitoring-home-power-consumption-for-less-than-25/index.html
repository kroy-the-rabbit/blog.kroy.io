<!DOCTYPE html>
<html lang="en-US" itemscope itemtype="http://schema.org/WebPage"><head><meta charset="UTF-8"><title>Monitoring Home Power Consumption for less than $25 – blog.kroy.io</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="dns-prefetch" href="//s.w.org"><script type="text/javascript" data-cfasync="false">
	var em_version         = '6.1.0';
	var em_track_user      = true;
	var em_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-89722449-1';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}

	if ( 'undefined' === typeof gaOptout ) {
		function gaOptout() {
			__gaTrackerOptout();
		}
	}
	
	if ( em_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

window.ga = __gaTracker;		__gaTracker('create', 'UA-89722449-1', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('send','pageview');
		__gaTracker( function() { window.ga = __gaTracker; } );
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + em_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
			window.ga = __gaTracker;		})();
		}
</script><style type="text/css" media="all">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style><link rel="stylesheet" id="wp-block-library-css" href="https://blog.kroy.io/wp-includes/css/dist/block-library/style.min.css" media="all"><style id="wp-block-library-inline-css">
.has-text-align-justify{text-align:justify;}
</style><link rel="stylesheet" id="wp-block-library-theme-css" href="https://blog.kroy.io/wp-includes/css/dist/block-library/theme.min.css" media="all"><link rel="stylesheet" id="wpautoterms_css-css" href="https://blog.kroy.io/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css" media="all"><link rel="stylesheet" id="sinatra-styles-css" href="https://blog.kroy.io/wp-content/themes/sinatra/assets/css/style.min.css" media="all"><link rel="stylesheet" id="sinatra-dynamic-styles-css" href="https://blog.kroy.io/wp-content/uploads/sinatra/dynamic-styles.css" media="all"><link rel="stylesheet" id="addtoany-css" href="https://blog.kroy.io/wp-content/plugins/add-to-any/addtoany.min.css" media="all"><style id="addtoany-inline-css">
@media screen and (max-width:980px){
.a2a_floating_style.a2a_vertical_style{display:none;}
}
</style><link rel="stylesheet" id="jetpack_css-css" href="https://blog.kroy.io/wp-content/plugins/jetpack/css/jetpack.css" media="all"><script>
var exactmetrics_frontend = {"js_events_tracking":"true","download_extensions":"zip,mp3,mpeg,pdf,docx,pptx,xlsx,rar","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/PLACEHOLDER.wpsho","hash_tracking":"false"};
</script><script src="https://blog.kroy.io/wp-content/plugins/google-analytics-dashboard-for-wp/assets/js/frontend.min.js"></script><script src="https://blog.kroy.io/wp-includes/js/jquery/jquery.js"></script><script src="https://blog.kroy.io/wp-includes/js/jquery/jquery-migrate.min.js"></script><script src="https://blog.kroy.io/wp-content/plugins/add-to-any/addtoany.min.js"></script><script data-cfasync="false">
window.a2a_config=window.a2a_config||{};a2a_config.callbacks=[];a2a_config.overlays=[];a2a_config.templates={};
(function(d,s,a,b){a=d.createElement(s);b=d.getElementsByTagName(s)[0];a.async=1;a.src="https://static.addtoany.com/menu/page.js";b.parentNode.insertBefore(a,b);})(document,"script");
</script><style type="text/css">img#wpstats{display:none}</style><meta name="theme-color" content="#3857F1"><link rel="icon" href="https://blog.kroy.io/wp-content/uploads/2020/04/cropped-android-chrome-512x512-3-32x32.png" sizes="32x32"><link rel="icon" href="https://blog.kroy.io/wp-content/uploads/2020/04/cropped-android-chrome-512x512-3-192x192.png" sizes="192x192"><link rel="apple-touch-icon" href="https://blog.kroy.io/wp-content/uploads/2020/04/cropped-android-chrome-512x512-3-180x180.png"><meta name="msapplication-TileImage" content="https://blog.kroy.io/wp-content/uploads/2020/04/cropped-android-chrome-512x512-3-270x270.png"></head><body class="post-template-default single single-post postid-26 single-format-standard wp-embed-responsive sinatra-topbar__separators-regular sinatra-layout__fw-contained sinatra-with-dropdown-indicators sinatra-header-layout-1 sinatra-menu-animation-underline sinatra-header__separators-none si-single-title-in-content si-page-title-align-left comments-open si-has-sidebar sinatra-sidebar-style-3 sinatra-sidebar-position__right-sidebar si-sidebar-r__after-content entry-media-hover-style-1 sinatra-copyright-layout-1 si-input-supported validate-comment-form si-menu-accessibility">


<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header" role="banner" itemtype="https://schema.org/WPHeader" itemscope="itemscope"><div id="sinatra-header">
		<div id="sinatra-header-inner">
	
<div class="si-container si-header-container">

	
<div class="sinatra-logo si-header-element" itemtype="https://schema.org/Organization" itemscope="itemscope">
	<div class="logo-inner"><span class="site-title" itemprop="name">
						<a href="https://blog.kroy.io/" rel="home" itemprop="url">
							blog.kroy.io
						</a>
					</span><p class="site-description" itemprop="description">
						computers, tech, and whatever other random stuff crosses my mind.
					</p></div></div>

<nav class="site-navigation main-navigation sinatra-primary-nav sinatra-nav si-header-element" role="navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" aria-label="Site Navigation"><ul class="sinatra-primary-nav"><li><a href="https://blog.kroy.io/"><span>Home</span></a></li></ul></nav><div class="si-header-widgets si-header-element sinatra-widget-location-right"><div class="si-header-widget__search si-header-widget sinatra-hide-mobile-tablet"><div class="si-widget-wrapper">
<div aria-haspopup="true">
	<a href="#" class="si-search">
		<i class="si-icon si-search"></i>
	</a>

	<div class="si-search-simple si-search-container dropdown-item">
		<form role="search" aria-label="Site Search" method="get" class="si-search-form" action="https://blog.kroy.io/">

			<label class="si-form-label">
				<span class="screen-reader-text">Search for:</span>
				<input type="search" class="si-input-search" placeholder="Search" value="" name="s" autocomplete="off"></label>

			
			<button type="submit" class="sinatra-animate-arrow right-arrow" aria-hidden="true" role="button">
				<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="30px" height="18px" viewbox="0 0 30 18" enable-background="new 0 0 30 18" xml:space="preserve"><path class="arrow-handle" d="M2.511,9.007l7.185-7.221c0.407-0.409,0.407-1.071,0-1.48s-1.068-0.409-1.476,0L0.306,8.259 c-0.408,0.41-0.408,1.072,0,1.481l7.914,7.952c0.407,0.408,1.068,0.408,1.476,0s0.407-1.07,0-1.479L2.511,9.007z"></path><path class="arrow-bar" fill-rule="evenodd" clip-rule="evenodd" d="M1,8h28.001c0.551,0,1,0.448,1,1c0,0.553-0.449,1-1,1H1c-0.553,0-1-0.447-1-1
					                            C0,8.448,0.447,8,1,8z"></path></svg></button>
		</form>
	</div>
</div>
</div></div></div>
	<span class="si-header-element si-mobile-nav">
				<button class="si-hamburger hamburger--spin si-hamburger-sinatra-primary-nav" aria-label="Menu" aria-controls="sinatra-primary-nav" type="button">

			
			<span class="hamburger-box">
				<span class="hamburger-inner"></span>
			</span>

		</button>
			</span>

</div>	</div>
	</div>
		
<div class="page-header si-has-breadcrumbs">

	
	
	<div class="si-container si-breadcrumbs"><nav role="navigation" aria-label="Breadcrumbs" class="breadcrumb-trail breadcrumbs" itemprop="breadcrumb"><ul class="trail-items" itemscope itemtype="http://schema.org/BreadcrumbList"><meta name="numberOfItems" content="5"><meta name="itemListOrder" content="Ascending"><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item trail-begin"><a href="https://blog.kroy.io/" rel="home" itemprop="item"><span itemprop="name">Home</span></a><meta itemprop="position" content="1"></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item"><a href="https://blog.kroy.io/2017/" itemprop="item"><span itemprop="name">2017</span></a><meta itemprop="position" content="2"></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item"><a href="https://blog.kroy.io/2017/12/" itemprop="item"><span itemprop="name">December</span></a><meta itemprop="position" content="3"></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item"><a href="https://blog.kroy.io/2017/12/19/" itemprop="item"><span itemprop="name">19</span></a><meta itemprop="position" content="4"></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item trail-end"><span><span itemprop="name">Monitoring Home Power Consumption for less than $25</span></span><meta itemprop="position" content="5"></li></ul></nav></div>
</div>
	</header><div id="main" class="site-main">

		
<div class="si-container">

	<div id="primary" class="content-area">

		
		<main id="content" class="site-content" role="main" itemscope itemtype="http://schema.org/Blog"><article id="post-26" class="sinatra-article post-26 post type-post status-publish format-standard has-post-thumbnail hentry category-homelab category-rtlsdr" itemscope="" itemtype="https://schema.org/CreativeWork"><div class="post-category">

	<span class="cat-links"><span class="screen-reader-text">Posted in</span><span><a href="https://blog.kroy.io/category/homelab/" rel="category tag">HomeLab</a> <a href="https://blog.kroy.io/category/rtlsdr/" rel="category tag">RTLSDR</a></span></span>
</div>

<header class="entry-header"><h1 class="entry-title" itemprop="headline">
		Monitoring Home Power Consumption for less than $25	</h1>

</header><div class="entry-meta"><div class="entry-meta-elements">		<span class="post-author">
			<span class="posted-by vcard author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
				<span class="screen-reader-text">Posted by</span>

				
				<span>
										By 					<a class="url fn n" title="View all posts by Kroy" href="https://blog.kroy.io/author/kroy3348/" rel="author" itemprop="url">
						<span class="author-name" itemprop="name">Kroy</span>
					</a>
				</span>
			</span>
		</span>
		<span class="posted-on">December 19, 2017</span><span class="comments-link"><a href="https://blog.kroy.io/2017/12/19/monitoring-home-power-consumption-for-less-than-25/#respond" class="comments-link">No Comments</a></span></div></div><div class="post-thumb entry-media thumbnail"><img width="1024" height="518" src="https://blog.kroy.io/wp-content/uploads/2017/12/bgpower-1024x518.png" class="attachment-large size-large wp-post-image" alt="power"></div>
<div class="entry-content si-entry" itemprop="text">
	<div class="addtoany_share_save_container addtoany_content addtoany_content_top"><div class="a2a_kit a2a_kit_size_32 addtoany_list" data-a2a-url="https://blog.kroy.io/2017/12/19/monitoring-home-power-consumption-for-less-than-25/" data-a2a-title="Monitoring Home Power Consumption for less than $25"><a class="a2a_button_facebook" href="https://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Facebook" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_twitter" href="https://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Twitter" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_reddit" href="https://www.addtoany.com/add_to/reddit?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Reddit" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_linkedin" href="https://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="LinkedIn" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_hacker_news" href="https://www.addtoany.com/add_to/hacker_news?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Hacker News" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_email" href="https://www.addtoany.com/add_to/email?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Email" rel="nofollow noopener" target="_blank"></a><a class="a2a_dd addtoany_share_save addtoany_share" href="https://www.addtoany.com/share"></a></div></div>
<p>On almost a daily basis, I am bombarded with ads on Facebook for the <a href="https://sense.com/">Sense</a>.  This device allows you to monitor whole-home power consumption.</p>



<p>I could probably find room for such a device in the budget, but I <em>HATE</em> electricity.  Too many years of geeky endeavors have resulted in far too many shocks, and mains electricity scares the hell out of me.  That discounted the possibility of hooking some kind of sensor to a Raspberry Pi and directly measure the mains.</p>



<p>After I thought about it a bit, I realized it would be extremely simple to do something similar without any wires or hassle.</p>



<hr class="wp-block-separator"><h1 id="rtlsdr">RTL-SDR</h1>



<p>As I considered how I could accomplish this task, I came to a realization.  At least where I live, I haven’t seen a “meter reader” in at least a couple of decades.  This meant at least once a month, the power company was somehow retrieving my usage in an automated fashion.</p>



<p>Some research told me that the power company accomplishes this via a simple radio broadcast on the 900Mhz spectrum.  Once again, it was a task for the RTL-SDR that I use for a number of projects.</p>



<p>The RTL-SDR is just a cheap software-defined radio that can be had for less than $25 on Amazon with an antenna.  It can used for everything from monitoring cheap temperature and humidity sensors, tracking airplanes, and apparently, reading my own power meter.</p>



<p>The software is readily available for all flavors of Linux, and simple to install and use.</p>



<hr class="wp-block-separator"><h1 id="meterreading">Meter Reading</h1>



<p>It turns out, at least in the United States, most meters can be read using <a href="https://github.com/bemasher/rtlamr">this software</a>.  Don’t get me wrong, manually decoding radio packets isn’t necessarily difficult, but it makes me glad that some kind soul has done the legwork for this already.</p>



<p>And with one simple command, I was reading the power (and probably water) meters for my entire neighborhood:</p>



<p><code>~/gocode/bin/rtlamr -msgtype=idm --format=json -msgtype=scm+</code></p>



<figure class="wp-block-image"><img src="https://blog2.kroy.io/wp-content/uploads/2019/08/neighborhood-1-1024x523.png" alt="" class="wp-image-138" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/neighborhood-1-1024x523.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/neighborhood-1-300x153.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/neighborhood-1-768x392.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/neighborhood-1.png 1500w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p>I’m not going to lie.  It felt weird polling the meter readings for the entire neighborhood.  Out of the five different protocol types (‘msgtype’ option to  rtlamr), four of them were in use in my neighborhood, and I had access to hundreds of meters.</p>



<hr class="wp-block-separator"><h1 id="thehuntbegins">The Hunt Begins</h1>



<p>Once I was able to poll meters, it became a hunt for the proverbial needle-in-a-haystack to find my meter.  Amazingly, this was the longest part of the whole endeavor and ended up taking almost three hours.  There were a number of impediments to this goal:</p>



<ol><li>The meters only report every few minutes, and sometimes sporadically, instead of even on a set schedule.  So it becomes a matter of weeding through a few hundred readings to try and pick out your own.  Some meters will report two or three times for a single report on another.  This becomes important later for why this isn’t the best option for an instantaneous “Hey my house is currently using 150 Wh” reading.</li><li>In my neighborhood, there are four different protocols in use. This meant I had to repeat the first step for all four protocols.</li><li>The reading that’s reported when you look at the physical meter isn’t the same reading that’s reported wirelessly.</li></ol><p>That third point is obviously a huge problem when you are flying blind.  My meter was reading 55,151 kWh, so my eyes were scanning for a five digit number in the mess.  And of course searching the output wasn’t helping because by the time I got a reading (due to point #1 above), the number had moved.</p>



<p>Of course this is when I realized that the wireless reading from the meter was reporting in daWh (that’s decawatt/hours). With that knowledge, I was able to identify my own meter.  Fortunately, the rtlamr binary provides a simple way to filter by a specific unit, output json, and grab a single packet:</p>



<p><code>~/gocode/bin/rtlamr -msgtype=idm --format=json --filterid=XXXXXXX --single=true</code></p>



<figure class="wp-block-image"><img src="https://blog2.kroy.io/wp-content/uploads/2019/08/myreading-1-1024x126.png" alt="" class="wp-image-139" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/myreading-1-1024x126.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/myreading-1-300x37.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/myreading-1-768x94.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/myreading-1-1600x197.png 1600w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p><code>55422.79 kWh</code> used since my meter was replaced a few years ago.  I imagine there is some other useful information in there, like the PowerOutageFlags, DifferentialConsumptionLevels, and more.  But for now, I had my reading.</p>



<hr class="wp-block-separator"><h1 id="graphallthethings">Graph All the Things!</h1>



<p>Once I had JSON output, the sky is the limit for what can be accomplished.  My first reaction was to drop it in InfluxDB and use Grafana.  Unfortunately this method of reading the meter doesn’t really lend itself well to constant polling.  There are a few important things to notice in the following output:</p>



<figure class="wp-block-image"><img src="https://blog2.kroy.io/wp-content/uploads/2019/08/inconsistent.png" alt="" class="wp-image-140" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/inconsistent.png 651w,https://blog.kroy.io/wp-content/uploads/2019/08/inconsistent-300x81.png 300w" sizes="(max-width: 651px) 100vw, 651px"></figure><ul><li>The readings didn’t actually change between every report.  For example, three successive readings might be the same (despite many watt/hours in use), but only the fourth reading would report the ultimate change.</li><li>The time between reports really inconsistent.  One time would be two minutes, the next would be a single minute. I imagine it’s done this way to stagger out the signals in a neighborhood so they aren’t clambering over one another.  This meant my RTL-SDR was constantly polling for meter reading, which broke my temperature/humidity sensors for my fridge, monitoring the basement for water, and more.</li></ul><p>While I’ve seen some nice looking Grafana graphs, most of the time I really don’t think they look that nice. Sometimes they remind me a bit of “rrdgraph”.</p>



<p>Functional, sure, but they really just look terrible compared to a modern HTML5 graphing library. Not to mention, I always waste a ton of time fighting with Grafana trying to get it to even report “sane” numbers.</p>



<p>This also immediately discounted the idea of creating some sort of instantaneous usage report.  The meter wasn’t changing often enough to even get a minute-by-minute report. So I ditched Grafana and went with a simple relational database and some PHP.</p>



<hr class="wp-block-separator"><h1 id="phpsqlite3andjquery">PHP, SQLite3, and JQuery</h1>



<p>I use PHP.  There, I admitted it.  For heavy projects, I prefer something different.  But as I’ve been using PHP professionally since the PHP/FI days, it lends itself to extremely rapid development. And at least for quick and dirty home-tasks where I’m starting from scratch every time, some spectacularly ugly code.</p>



<p>That’s why I usually don’t post code examples, because I don’t care how anybody could do it better, why my code sucks, is a security blight or whatever else. It’s quick (I’ve only got a few hours of time in the code of this project), it’s dirty, it usually gets super creepy and crufty as I change directions 42 times, and I’m not exposing it to the Internet.  With that warning out of the way…</p>



<hr class="wp-block-separator"><h2 id="datacollection">Data Collection</h2>



<p>I decided I wanted a relational database, but didn’t want to mess with some heavy daemon.  While it’s running on my “collection” host, an N3700 with an SSD in it, at some point in the future this could run off a Raspberry Pi. SQLite3 was the only choice as it is lightweight and fast.</p>



<p>A simple cron script set up to run every hour on the hour captures the meter reading:</p>



<pre class="wp-block-code"><code>$unitid = XXXXXX;
$type= "idm";

exec("/scripts/gocode/bin/rtlamr -msgtype={$type} --format=json --filterid={$unitid} --single=true",$output);
$arr = json_decode(implode("\n",$output),true);
$meter_reading = $arr['Message']['LastConsumptionCount'];

if ($meter_reading > 1) {
     $r = new \reading($meter_reading);
}</code></pre>



<p>And the class that actually does the heavy lifting</p>



<pre class="wp-block-code"><code>class reading {

         private $db = null;
         private $reading = 0;

         private function getDb() {
             $db = new SQLite3(dirname(__FILE__) . '/whole_home_electricity.sqlite3');
             $db->query("CREATE TABLE IF NOT EXISTS byhour (id INTEGER PRIMARY KEY ASC, ymd integer, hour tinyint, reading bigint,last_difference integer,UNIQUE(ymd,hour))");
             $db->query("CREATE TABLE IF NOT EXISTS byday (id INTEGER PRIMARY KEY ASC, ymd integer, reading bigint,last_difference integer,UNIQUE(ymd))");
             $db->query("CREATE TABLE IF NOT EXISTS bymonth (id INTEGER PRIMARY KEY ASC, ym integer, reading bigint,last_difference integer,UNIQUE(ym))");
             $db->query("CREATE TABLE IF NOT EXISTS byweek (id INTEGER PRIMARY KEY ASC, year integer, week tinyint, reading bigint,last_difference integer,UNIQUE(year,week))");
             return $db;
         }

         private function getLastReading($table) {
             $ld_res = $this->db->query("select * from {$table} order by id desc limit 1");
             if ($ld_row = $ld_res->fetchArray()) {
                 return $this->reading-$ld_row['reading'];
             }
             return 0;

         }

         public function __construct($reading) {
             $this->db = $this->getDb();
             $this->reading = $reading;


             $ym = date("Ym");
             $year = date("Y");
             $week = date("W");
             $ymd = date("Ymd");
             $hour = date("H");

             //By Hour
             $res = $this->db->query("select * from byhour where ymd={$ymd} and hour={$hour}");
             if (!$row = $res->fetchArray()) {
                 $last_difference = $this->getLastReading("byhour");
                 $ins=$this->db->prepare("insert into byhour (ymd,hour,reading,last_difference) values (:ymd,:hour,:reading,:last_difference)");
                 $ins->bindValue(':ymd', date("Ymd"), SQLITE3_INTEGER);
                 $ins->bindValue(':hour', date("G"), SQLITE3_INTEGER);
                 $ins->bindValue(':reading', $this->reading, SQLITE3_INTEGER);
                 $ins->bindValue(':last_difference', $last_difference, SQLITE3_INTEGER);
                 @$ins->execute();
             }
             //End By Hour


             //By Day
             $res = $this->db->query("select * from byday where ymd={$ymd}");
             if (!$row = $res->fetchArray()) {
                 $last_difference = $this->getLastReading("byday");
                 $ins=$this->db->prepare("insert into byday (ymd,reading,last_difference) values (:ymd,:reading,:last_difference)");
                 $ins->bindValue(':ymd', $ymd, SQLITE3_INTEGER);
                 $ins->bindValue(':reading', $this->reading, SQLITE3_INTEGER);
                 $ins->bindValue(':last_difference', $last_difference, SQLITE3_INTEGER);
                 @$ins->execute();
             }
             //End Day
             //
             //
             
             //By Week
             $res = $this->db->query("select * from byweek where year={$year} and week={$week}");
             if (!$row = $res->fetchArray()) {
                 $last_difference = $this->getLastReading("byweek");
                 $ins=$this->db->prepare("insert into byweek (year,week,reading,last_difference) values (:year,:week,:reading,:last_difference)");
                 $ins->bindValue(':year', $year, SQLITE3_INTEGER);
                 $ins->bindValue(':week', $week, SQLITE3_INTEGER);
                 $ins->bindValue(':reading', $this->reading, SQLITE3_INTEGER);
                 $ins->bindValue(':last_difference', $last_difference, SQLITE3_INTEGER);
                 @$ins->execute();
             }
             //End Week
             
             //continues for month, and eventually year
             
             
             //While we are at it, back everything up with "versioning"
             //Backup

             if (file_exists("/mnt/Backups/backup_mounted")) {
                 for ($i = 48; $i > 0; $i--) {
                     $a = $i - 1;
                     rename("/mnt/Backups/analog/whole_home_electricity/whole_home_electricity.sqlite3.{$a}", "/mnt/Backups/analog/whole_home_electricity/whole_home_electricity.sqlite3.{$i}");
                 }
                 rename("/mnt/Backups/analog/whole_home_electricity/whole_home_electricity.sqlite3","/mnt/Backups/analog/whole_home_electricity/whole_home_electricity.sqlite3.0");
                 copy(dirname(__FILE__) . '/whole_home_electricity.sqlite3',"/mnt/Backups/analog/whole_home_electricity/whole_home_electricity.sqlite3");
             }</code></pre>



<p>The theory behind this is simple.  Once an hour, pull a reading.  If a reading doesn’t exist for the current day, hour, week, month, year, pull the last reading, grab the difference, and store it.</p>



<h5 id="weirdalert">Weird alert</h5>



<p>This does create an oddity as the datapoint for <code>20171217 09</code> actually represents the data for <code>08:00-09:00</code>.  Similarly this occurs for day, week, and month.  It’s not a huge problem, but it just means that when I pull a day’s worth of data, I pull where the <code>hour>0</code> and then the following day’s <code>hour=0</code>.  It’s just a slight modification on the output.  One of those crufty things born out of a change of direction that I should probably go back and change (but never will).</p>



<h1 id="theoutput">The Output</h1>



<p>The output is just a simple HTML5 page that calls a json-generating PHP script via JQuery/ajax.  The result ends up looking something like this:</p>



<figure class="wp-block-image"><img src="https://blog2.kroy.io/wp-content/uploads/2017/12/bgpower-1024x518.png" alt="power" class="wp-image-137" srcset="https://blog.kroy.io/wp-content/uploads/2017/12/bgpower-1024x518.png 1024w,https://blog.kroy.io/wp-content/uploads/2017/12/bgpower-300x152.png 300w,https://blog.kroy.io/wp-content/uploads/2017/12/bgpower-768x388.png 768w,https://blog.kroy.io/wp-content/uploads/2017/12/bgpower-1600x809.png 1600w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p>I’ve used all sorts of frameworks and APIs over the years, but I can’t speak highly enough of <a href="https://canvasjs.com/">CanvasJS</a>.</p>



<p>It’s not free, and I’ll probably end up buying a license so I can use it here and elsewhere.  It’s by far the easiest to use and nicest-looking framework for generating graphs I’ve used in a while.</p>



<p>In any case.  Actual HTML for this is fairly straightforward:</p>



<pre class="wp-block-code"><code><!DOCTYPE HTML>
<html>
<head>
<link href="css/jquery-ui.1.11.2.min.css" rel="stylesheet" />
<script src="js/jquery-1.11.1.min.js"></script>
<script src="js/jquery-ui.1.11.2.min.js"></script>
<script>

//https://stackoverflow.com/questions/19491336/get-url-parameter-jquery-or-how-to-get-query-string-values-in-js
$.urlParam = function(name){
    var results = new RegExp('[\?&]' + name + '=([^&#]*)').exec(window.location.href);
    if (results) {
        return results[1] || 0;
    }
    return 0;
}

$(document).ready(function(){
    updateByHour();
    updateTheRest();
});

function updateByHour() {
    var postvars = { action: "byhour"};
    if ($.urlParam('byHourDay') != 0) {
        postvars.byHourDay = $.urlParam('byHourDay');
    }

    $.post( "api.php", postvars, function( result) {
        result = $.parseJSON(result);
        points = [];
        $.each(result, function (i,v)
        {
              points.push({y:v, label: i+"h", indexLabelFontColor: "#000000",indexLabelPlacement:"inside", indexLabel:"{y}Wh"});
        });

        chart_title = "Hourly Consumption";
        if (postvars.byHourDay) {
            chart_title += " (" + decodeURIComponent(postvars.byHourDay) + ")";
            $("#goback").fadeIn(600);
        } else {
            chart_title += " (today)";
        }

        var hourOptions= {
        theme: "light2",
        animationEnabled: true,
        title: {
            text: chart_title
        },
        data: [{
            type: "column", //change it to line, area, bar, pie, etc
            dataPoints: points
            }]
    };

    $("#byHourContainer").CanvasJSChart(hourOptions)
    });
}

function refreshByHour(day) {
    if (day) {
        window.history.pushState("", "","/wholehome/index.php?byHourDay=" + day);
    } else {
        window.history.pushState("", "","/wholehome/index.php");
    }
    updateByHour();
}

function updateTheRest() {
    $.post( "api.php", { action: "byday"}, function( result) {
        result = $.parseJSON(result);
        points = [];
        $.each(result, function (i,v)
        {
            points.push({y:v, label: i, indexLabelFontColor: "#000000", indexLabelPlacement:"inside", indexLabel:"{y}kWh", click: function(e) { refreshByHour(i); } });
        });


		var dayOptions= {
			animationEnabled: true,
				theme: "light2",
				title:{
				text: "Daily Consumption"
			},
				axisY2:{
				prefix: "",
	        //				lineThickness: 0
			},
				toolTip: {
				shared: true
			},
				legend:{
				verticalAlign: "top",
				horizontalAlign: "center"
			},
			data: [
				{
					type: "bar",
					name: "Kilowatt/Hour",
					axisYType: "secondary",
					//color: "#A87CA0",
					dataPoints: points
				}
			]};
		$("#byDayContainer").CanvasJSChart(dayOptions);

	});

    $.post( "api.php", { action: "byWeek"}, function( result) {
        result = $.parseJSON(result);
        points = [];
        $.each(result, function (i,v)
        {
            points.push({y:v, label: i, indexLabelFontColor: "#000000", indexLabelPlacement:"inside", indexLabel:"{y}kWh"});
        });


		var monthOptions= {
			animationEnabled: true,
				theme: "light2",
				title:{
				text: "Weekly Consumption"
			},
				axisY2:{
				prefix: "",
	        //				lineThickness: 0
			},
				toolTip: {
				shared: true
			},
				legend:{
				verticalAlign: "top",
				horizontalAlign: "center"
			},
			data: [
				{
					type: "bar",
					name: "Kilowatt/Hour",
					axisYType: "secondary",
					//color: "#A87CA0",
					dataPoints: points
				}
			]};
		$("#byWeekContainer").CanvasJSChart(monthOptions);
    });

    $.post( "api.php", { action: "bymonth"}, function( result) {
        result = $.parseJSON(result);
        points = [];
        $.each(result, function (i,v)
        {
            points.push({y:v, label: i, indexLabelFontColor: "#000000", indexLabelPlacement:"inside", indexLabel:"{y}kWh"});
        });


		var monthOptions= {
			animationEnabled: true,
				theme: "light2",
				title:{
				text: "Monthly Consumption"
			},
				axisY2:{
				prefix: "",
	        //				lineThickness: 0
			},
				toolTip: {
				shared: true
			},
				legend:{
				verticalAlign: "top",
				horizontalAlign: "center"
			},
			data: [
				{
					type: "bar",
					name: "Kilowatt/Hour",
					axisYType: "secondary",
					//color: "#A87CA0",
					dataPoints: points
				}
			]};
		$("#byMonthContainer").CanvasJSChart(monthOptions);

	});
}

</script>
</head>
<body >
<h1 style="color:#000000">Kilowattage</h1> <span id="goback" style="display:none;"><a href='' onclick='refreshByHour(); $("#goback").fadeOut(600); return false;' style="color:#000000">View Today</a></span><br />
<p>
<div class="resizable" style="height: 370px;border:1px solid gray;">
    <div id="byHourContainer" style="height: 100%; width: 100%;"></div><br />
</div>
<div class="resizable" style="height: 370px;border:1px solid gray;">
    <div id="byDayContainer" style="height: 100%; width: 100%;"></div>
</div>
<div class="resizable" style="height: 370px;border:1px solid gray;">
    <div id="byWeekContainer" style="height: 100%; width: 100%;"></div>
</div>
<div class="resizable" style="height: 370px;border:1px solid gray;">
    <div id="byMonthContainer" style="height: 100%; width: 100%;"></div>
</div>

</p>
<script src="js/jquery.canvasjs.min.js"></script>
</body>
</html></code></pre>



<p>Without getting bogged down with details, the crux of this is pretty simple:</p>



<p>Check to see if we want to grab a specific day.  This is so I can click on the day and get the specific usage for that day (and reload the chart):</p>



<pre class="wp-block-code"><code>    var postvars = { action: "byhour"};    if ($.urlParam('byHourDay') != 0) {        postvars.byHourDay = $.urlParam('byHourDay');    }</code></pre>



<p>Do an AJAX post to <code>api.php</code>.  Parse out the results and put them in an array of data points:</p>



<pre class="wp-block-code"><code>    $.post( "api.php", postvars, function( result) {
        result = $.parseJSON(result);
        points = [];
        $.each(result, function (i,v)
        {
              points.push({y:v, label: i+"h", indexLabelFontColor: "#000000",indexLabelPlacement:"inside", indexLabel:"{y}Wh"});
        });</code></pre>



<p>Build the chart and change some text around so we know we are looking at a different day</p>



<pre class="wp-block-code"><code>chart_title = "Hourly Consumption";
if (postvars.byHourDay) {
            chart_title += " (" + decodeURIComponent(postvars.byHourDay) + ")";
            $("#goback").fadeIn(600);
        } else {
            chart_title += " (today)";
        }

        var hourOptions= {
        theme: "light2",
        animationEnabled: true,
        title: {
            text: chart_title
        },
        data: [{
            type: "column", //change it to line, area, bar, pie, etc
            dataPoints: points
            }]
    };

    $("#byHourContainer").CanvasJSChart(hourOptions)
    });
}</code></pre>



<p>This repeats for the day, week, month, and eventually year.  With this, I can click on the day under the daily charts, and have it refresh the hourly chart with the new day/</p>



<hr class="wp-block-separator"><h1 id="theapi">The API</h1>



<p>Finally, I needed an API to connect the HTML to the Sqlite3 database.</p>



<p>Stuff like this is where I always end up missing some of the heavier frameworks I’ve developed and I used on a daily basis.</p>



<p>I’m just reading the most recent backup copy of my database, to prevent locking issues; I only want to do something if my Backup drive gets mounted:</p>



<pre class="wp-block-code"><code>if (file_exists("/mnt/Backups/backup_mounted")) {
    $usage = new \usage();
    if (!empty($_POST)) {
        if ($_POST['action'] == 'byday') {
            echo json_encode($usage->getByDay());
        }
        if ($_POST['action'] == 'bymonth') {
            echo json_encode($usage->getByMonth());
        }
        if ($_POST['action'] == 'byWeek') {
            echo json_encode($usage->getByWeek());
        }
        if ($_POST['action'] == 'byhour') {
            $byHourDay = strlen($_POST['byHourDay']) > 0 ? urldecode($_POST['byHourDay']) : null;
            echo json_encode($usage->getByHour($byHourDay));
        }
    }
}</code></pre>



<p>Just a simple director.  Call a method depending on URL parameters.</p>



<p>This is where it gets pretty crufty.  I was in the home stretch and just wanted to be done.  Here’s what some of the functions look like:</p>



<pre class="wp-block-code"><code>class usage {

    private $db = null;

    public function __construct() {
        $this->db = new SQLite3("/mnt/Backups/analog/whole_home_electricity/whole_home_electricity.sqlite3");
    }
    
        public function getByDay($limit = 10) {
        $ret = [];

        $ld_res = $this->db->query("select * from byday order by ymd limit {$limit}");
        while ($ld_data = $ld_res->fetchArray()) {
            $fdate = date("j M Y",strtotime(($ld_data['ymd']-1)));
            
            ##in decawatts, want kilo
            $ret[$fdate] = $ld_data['last_difference']/100;
        }

        ##Add in today's usage since it hasn't been written yet
        $fdate = date("j M Y");
        
        $tot = 0;
        $byhour = $this->getByHour();
        foreach ($byhour as $usage) {
            $tot += $usage;
        }

        ##Swap the watts back to kilo
        $ret[$fdate] = $tot/1000;

        return $ret;
    }

    public function getByHour($date = null) {
    
        ##Pull today if nothing passed in
        if ($date == null) {
            $date = date("Ymd");
        } else {
            //format that guy
            $date = date("Ymd",strtotime($date));
        }
        
        ##This addresses the problem where I am writing the previous hour's data to the current hour
        $tomm = $date+1;

        $ret = [];

        ##Usage is marked current hour when it actually means last hour
        ##so do some fanangling
        $ld_res = $this->db->query("select * from byhour where ((ymd={$date} and hour > 0) || (ymd={$tomm} and hour=0)) order by ymd,hour");
        while ($ld_data = $ld_res->fetchArray()) {
            $hour = $ld_data['hour'] - 1;
            if ($hour < 0) {
                $hour = 23;
            }
            //convert to watts
            $ret[$hour] = $ld_data['last_difference']*10;
        }
        
        ##Fill in blanks spots with "0" in the final output so we have a full 24 hours worth
        for($i=0; $i < 24; $i++) {
            if (!isset($ret[$i])) {
                $ret[$i] = 0;
            }
        }
        ksort($ret);
        return $ret;
    }
    </code></pre>



<p>And that’s that!</p>



<hr class="wp-block-separator"><h1 id="theresults">The Results</h1>



<p>The end result is a decent looking set of graphs that can be manipulated a bit. I’ve only just got full data collection going, so it will be a few weeks before the graph truly fills out and becomes interesting.</p>



<figure class="wp-block-image"><img src="https://blog2.kroy.io/wp-content/uploads/2019/08/final1-1024x542.png" alt="results
" class="wp-image-141" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/final1-1024x542.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/final1-300x159.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/final1-768x407.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/final1-1600x847.png 1600w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p>And some fun things emerge:</p>



<figure class="wp-block-image"><img src="https://blog2.kroy.io/wp-content/uploads/2019/08/replication-2-1024x126.png" alt="replication
" class="wp-image-142" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/replication-2-1024x126.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/replication-2-300x37.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/replication-2-768x95.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/replication-2-1600x197.png 1600w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p>and:</p>



<figure class="wp-block-image"><img src="https://blog2.kroy.io/wp-content/uploads/2019/08/laundry-1024x126.png" alt="laundry" class="wp-image-143" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/laundry-1024x126.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/laundry-300x37.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/laundry-768x94.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/laundry-1600x197.png 1600w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><hr class="wp-block-separator"><h1 id="endingthoughtsandtodos">Ending thoughts and To-dos</h1>



<p>This was a fun little project that really didn’t take me much time.  Now that I’m collecting the data, I’ll be able to build out the reports a bit more.</p>



<p>The next big thing on my list for this is to include my lab power consumption as a stacked graph, so I can see how much of actual usage is my lab (400+ watts).</p>
<div class="addtoany_share_save_container addtoany_content addtoany_content_bottom"><div class="a2a_kit a2a_kit_size_32 addtoany_list" data-a2a-url="https://blog.kroy.io/2017/12/19/monitoring-home-power-consumption-for-less-than-25/" data-a2a-title="Monitoring Home Power Consumption for less than $25"><a class="a2a_button_facebook" href="https://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Facebook" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_twitter" href="https://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Twitter" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_reddit" href="https://www.addtoany.com/add_to/reddit?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Reddit" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_linkedin" href="https://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="LinkedIn" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_hacker_news" href="https://www.addtoany.com/add_to/hacker_news?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Hacker News" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_email" href="https://www.addtoany.com/add_to/email?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Email" rel="nofollow noopener" target="_blank"></a><a class="a2a_dd addtoany_share_save addtoany_share" href="https://www.addtoany.com/share"></a></div></div></div>




<div class="entry-footer">

	<span class="last-updated">Last updated on August 29, 2019</span>
</div>


<section class="author-box" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><div class="author-box-avatar">
		<img alt="" src="https://secure.gravatar.com/avatar/347d9cf482cfe91444ae0d59550ad83c?s=75&d=mm&r=g" srcset="https://secure.gravatar.com/avatar/347d9cf482cfe91444ae0d59550ad83c?s=150&d=mm&r=g 2x" class="avatar avatar-75 photo" height="75" width="75"></div>

	<div class="author-box-meta">
		<h4 class="author-box-title">
							<a href="https://blog.kroy.io/author/kroy3348/" class="url fn n" rel="author" itemprop="url">
				Kroy	
				</a>
						</h4>

		
		
		<div class="author-box-content" itemprop="description">
			sometimes hacker of things and other things...		</div>

		
<div class="more-posts-button">
	<a href="https://blog.kroy.io/author/kroy3348/" class="si-btn btn-text-1" role="button"><span>View All Posts</span></a>
</div>
	</div>

</section><section class="post-nav" role="navigation"><h2 class="screen-reader-text">Post navigation</h2>

	<div class="nav-previous"><h6 class="nav-title">Previous Post</h6><a href="https://blog.kroy.io/2017/08/14/fully-embracing-docker/" rel="prev"><div class="nav-content"><img width="75" height="75" src="https://blog.kroy.io/wp-content/uploads/2017/08/Screen-Shot-2017-08-14-at-2.38.19-PM-150x150.png" class="attachment-75x75 size-75x75 wp-post-image" alt="docker" itemprop="image"><span>Fully embracing Docker</span></div></a></div><div class="nav-next"><h6 class="nav-title">Next Post</h6><a href="https://blog.kroy.io/2018/05/02/building-a-disk-tower-for-pain-and-no-profit/" rel="next"><div class="nav-content"><span>Building a Disk Tower, for all pain and no profit</span> <img width="75" height="75" src="https://blog.kroy.io/wp-content/uploads/2018/05/zleVN8t-150x150.jpg" class="attachment-75x75 size-75x75 wp-post-image" alt="tower" itemprop="image"></div></a></div>
</section></article><section id="comments" class="comments-area"><div class="comments-title-wrapper center-text">
		<h3 class="comments-title">
			Comments		</h3>

					<p class="no-comments">No comments yet. Why don’t you start the discussion?</p>
			</div>

	<ol class="comment-list"></ol><div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2017/12/19/monitoring-home-power-consumption-for-less-than-25/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://blog.kroy.io/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-textarea"><textarea name="comment" id="comment" cols="44" rows="8" class="textarea-comment" placeholder="Write a comment…" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"><label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><span class="sinatra-submit-form-button"><input name="submit" type="submit" id="comment-submit" class="si-btn primary-button" value="Post Comment"></span> <input type="hidden" name="comment_post_ID" value="26" id="comment_post_ID"><input type="hidden" name="comment_parent" id="comment_parent" value="0"></p></form>	</div>
	
</section></main></div>

	
<aside id="secondary" class="widget-area si-sidebar-container" itemtype="http://schema.org/WPSideBar" itemscope="itemscope" role="complementary"><div class="si-sidebar-inner">
		
				<div id="recent-posts-2" class="si-sidebar-widget si-widget si-entry widget widget_recent_entries">		<h4 class="widget-title">Recent Posts</h4>		<ul><li>
					<a href="https://blog.kroy.io/2020/05/04/vyos-from-scratch-edition-1/">VyOS from Scratch – Edition 1</a>
									</li>
											<li>
					<a href="https://blog.kroy.io/2020/01/17/the-baby-wyse-the-dell-3040/">A Baby WYSE, the 3040</a>
									</li>
											<li>
					<a href="https://blog.kroy.io/2019/12/08/the-wyse-5070-a-perfect-little-vyos-device/">The WYSE 5070, a perfect little VyOS device</a>
									</li>
											<li>
					<a href="https://blog.kroy.io/2019/11/21/battle-of-the-bare-metal-routers/">Battle of the Bare Metal Routers</a>
									</li>
											<li>
					<a href="https://blog.kroy.io/2019/10/28/migrating-a-efi-linux-install-to-a-new-server/">Migrating an EFI Linux Install to a new Server</a>
									</li>
					</ul></div><div id="archives-2" class="si-sidebar-widget si-widget si-entry widget widget_archive"><h4 class="widget-title">Archives</h4>		<ul><li><a href="https://blog.kroy.io/2020/05/">May 2020</a></li>
	<li><a href="https://blog.kroy.io/2020/01/">January 2020</a></li>
	<li><a href="https://blog.kroy.io/2019/12/">December 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/11/">November 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/10/">October 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/09/">September 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/08/">August 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/01/">January 2019</a></li>
	<li><a href="https://blog.kroy.io/2018/11/">November 2018</a></li>
	<li><a href="https://blog.kroy.io/2018/07/">July 2018</a></li>
	<li><a href="https://blog.kroy.io/2018/05/">May 2018</a></li>
	<li><a href="https://blog.kroy.io/2017/12/">December 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/08/">August 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/07/">July 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/06/">June 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/05/">May 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/04/">April 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/03/">March 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/02/">February 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/01/">January 2017</a></li>
		</ul></div><div id="categories-2" class="si-sidebar-widget si-widget si-entry widget widget_categories"><h4 class="widget-title">Categories</h4>		<ul><li class="cat-item cat-item-12"><a href="https://blog.kroy.io/category/ceph/">ceph</a>
</li>
	<li class="cat-item cat-item-19"><a href="https://blog.kroy.io/category/debian/">Debian</a>
</li>
	<li class="cat-item cat-item-22"><a href="https://blog.kroy.io/category/docker/">Docker</a>
</li>
	<li class="cat-item cat-item-24"><a href="https://blog.kroy.io/category/virtualization/esxi/">ESXi</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://blog.kroy.io/category/freenas/">freenas</a>
</li>
	<li class="cat-item cat-item-26"><a href="https://blog.kroy.io/category/hardware/">Hardware</a>
</li>
	<li class="cat-item cat-item-29"><a href="https://blog.kroy.io/category/hardware-hacks/">Hardware Hacks</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://blog.kroy.io/category/homelab/">HomeLab</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://blog.kroy.io/category/mediaserver/">mediaserver</a>
</li>
	<li class="cat-item cat-item-15"><a href="https://blog.kroy.io/category/mikrotik/">mikrotik</a>
</li>
	<li class="cat-item cat-item-20"><a href="https://blog.kroy.io/category/networking/">Networking</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://blog.kroy.io/category/nucnucnuc/">nucnucnuc</a>
</li>
	<li class="cat-item cat-item-9"><a href="https://blog.kroy.io/category/pfsense/">pfsense</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://blog.kroy.io/category/proxmox/">proxmox</a>
</li>
	<li class="cat-item cat-item-25"><a href="https://blog.kroy.io/category/virtualization/proxmox-virtualization/">Proxmox</a>
</li>
	<li class="cat-item cat-item-13"><a href="https://blog.kroy.io/category/qnap/">QNAP</a>
</li>
	<li class="cat-item cat-item-31"><a href="https://blog.kroy.io/category/homelab/rack-migration/">Rack Migration</a>
</li>
	<li class="cat-item cat-item-14"><a href="https://blog.kroy.io/category/routeros/">RouterOS</a>
</li>
	<li class="cat-item cat-item-18"><a href="https://blog.kroy.io/category/routing/" title="Stuff about routing">Routing</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://blog.kroy.io/category/rtlsdr/">RTLSDR</a>
</li>
	<li class="cat-item cat-item-30"><a href="https://blog.kroy.io/category/storage/">Storage</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://blog.kroy.io/category/sysadmin/">SysAdmin</a>
</li>
	<li class="cat-item cat-item-23"><a href="https://blog.kroy.io/category/virtualization/">Virtualization</a>
</li>
	<li class="cat-item cat-item-16"><a href="https://blog.kroy.io/category/vyos/">VyOS</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://blog.kroy.io/category/zfs/">ZFS</a>
</li>
		</ul></div><div id="meta-2" class="si-sidebar-widget si-widget si-entry widget widget_meta"><h4 class="widget-title">Meta</h4>			<ul><li><a href="https://blog.kroy.io/wp-login.php">Log in</a></li>
			<li><a href="https://blog.kroy.io/feed/">Entries feed</a></li>
			<li><a href="https://blog.kroy.io/comments/feed/">Comments feed</a></li>
			<li><a href="https://wordpress.org/">WordPress.org</a></li>			</ul></div><div id="custom_html-2" class="widget_text si-sidebar-widget si-widget si-entry widget widget_custom_html"><div class="textwidget custom-html-widget"><div id="amzn-assoc-ad-96eac8be-1743-4b44-98e2-f274484e1cac"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=96eac8be-1743-4b44-98e2-f274484e1cac"></script></div></div>
			</div>

</aside></div>

		
	</div>
	
	
			<footer id="colophon" class="site-footer" role="contentinfo" itemtype="http://schema.org/WPFooter" itemscope="itemscope"><div id="sinatra-copyright" class="contained-separator">
	<div class="si-container">
		<div class="si-flex-row">

			<div class="col-xs-12 center-xs col-md flex-basis-auto start-md"><div class="si-copyright-widget__text si-copyright-widget sinatra-all"><span>Copyright 2020 — blog.kroy.io. All rights reserved. <a href="https://sinatrawp.com/" class="imprint" target="_blank" rel="noopener noreferrer">Sinatra WordPress Theme</a></span></div></div>
			<div class="col-xs-12 center-xs col-md flex-basis-auto end-md"></div>

		</div>
	</div>
</div>

		</footer></div>

<a href="#" id="si-scroll-top" class="si-smooth-scroll" title="Scroll to Top">
	<span class="si-scroll-icon" aria-hidden="true">
		<i class="si-icon si-chevron-up top-icon"></i>
		<i class="si-icon si-chevron-up"></i>
	</span>
	<span class="screen-reader-text">Scroll to Top</span>
</a>
<div class="a2a_kit a2a_kit_size_32 a2a_floating_style a2a_vertical_style" style="right:0px;top:100px;background-color:transparent;"><a class="a2a_button_facebook" href="https://www.addtoany.com/add_to/facebook?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Facebook" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_twitter" href="https://www.addtoany.com/add_to/twitter?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Twitter" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_reddit" href="https://www.addtoany.com/add_to/reddit?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Reddit" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_linkedin" href="https://www.addtoany.com/add_to/linkedin?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="LinkedIn" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_hacker_news" href="https://www.addtoany.com/add_to/hacker_news?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Hacker News" rel="nofollow noopener" target="_blank"></a><a class="a2a_button_email" href="https://www.addtoany.com/add_to/email?linkurl=https%3A%2F%2Fblog.kroy.io%2F2017%2F12%2F19%2Fmonitoring-home-power-consumption-for-less-than-25%2F&linkname=Monitoring%20Home%20Power%20Consumption%20for%20less%20than%20%2425" title="Email" rel="nofollow noopener" target="_blank"></a><a class="a2a_dd addtoany_share_save addtoany_share" href="https://www.addtoany.com/share"></a></div><script src="https://blog.kroy.io/wp-content/plugins/wplegalpages/admin/js/jquery.cookie.min.js"></script><script>
var sinatra_vars = {"ajaxurl":"https:\/\/blog.kroy.io\/wp-admin\/admin-ajax.php","nonce":"273c5609c8","responsive-breakpoint":"960","strings":{"comments_toggle_show":"Leave a Comment","comments_toggle_hide":"Hide Comments"}};
</script><script src="https://blog.kroy.io/wp-content/themes/sinatra/assets/js/sinatra.min.js"></script><script>
	!function(){var e=-1<navigator.userAgent.toLowerCase().indexOf("webkit"),t=-1<navigator.userAgent.toLowerCase().indexOf("opera"),n=-1<navigator.userAgent.toLowerCase().indexOf("msie");(e||t||n)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var e,t=location.hash.substring(1);/^[A-z0-9_-]+$/.test(t)&&(e=document.getElementById(t))&&(/^(?:a|select|input|button|textarea)$/i.test(e.tagName)||(e.tabIndex=-1),e.focus())},!1)}();
	</script><script type="text/javascript" src="https://stats.wp.com/e-202028.js" async="async" defer></script><script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:8.7',blog:'166765678',post:'26',tz:'-5',srv:'blog.kroy.io'} ]);
	_stq.push([ 'clickTrackerInit', '166765678', '26' ]);
</script><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><symbol id="icon-chat" viewbox="0 0 576 512"><path d="M512 160h-96V64c0-35.3-28.7-64-64-64H64C28.7 0 0 28.7 0 64v160c0 35.3 28.7 64 64 64h32v52c0 7.1 5.8 12 12 12 2.4 0 4.9-.7 7.1-2.4L224 288h128c35.3 0 64-28.7 64-64v-32h96c17.6 0 32 14.4 32 32v160c0 17.6-14.4 32-32 32h-64v49.6l-80.2-45.4-7.3-4.2H256c-17.6 0-32-14.4-32-32v-96l-32 18.1V384c0 35.3 28.7 64 64 64h96l108.9 61.6c2.2 1.6 4.7 2.4 7.1 2.4 6.2 0 12-4.9 12-12v-52h32c35.3 0 64-28.7 64-64V224c0-35.3-28.7-64-64-64zm-128 64c0 17.6-14.4 32-32 32H215.6l-7.3 4.2-80.3 45.4V256H64c-17.6 0-32-14.4-32-32V64c0-17.6 14.4-32 32-32h288c17.6 0 32 14.4 32 32v160z"></path></symbol><symbol id="icon-quote" viewbox="0 0 123.961 123.961"><path d="M49.8 29.032c3.1-1.3 4.4-5 3-8l-4.9-10.3c-1.4-2.899-4.8-4.2-7.8-2.899-8.5 3.6-15.8 8.3-21.6 14C11.4 28.532 6.6 36.232 4 44.732c-2.6 8.601-4 20.3-4 35.2v30.7c0 3.3 2.7 6 6 6h39.3c3.3 0 6-2.7 6-6v-39.3c0-3.301-2.7-6-6-6H26.5c.2-10.101 2.6-18.2 7-24.301 3.6-4.898 9-8.898 16.3-11.999zM120.4 29.032c3.1-1.3 4.399-5 3-8l-4.9-10.199c-1.4-2.9-4.8-4.2-7.8-2.9-8.4 3.6-15.601 8.3-21.5 13.9-7.101 6.8-12 14.5-14.601 23-2.6 8.399-3.899 20.1-3.899 35.1v30.7c0 3.3 2.7 6 6 6H116c3.3 0 6-2.7 6-6v-39.3c0-3.301-2.7-6-6-6H97.1c.2-10.101 2.601-18.2 7-24.301 3.6-4.899 9-8.899 16.3-12z"></path></symbol></svg><div class="wpautoterms-footer"><p>
		<a href="https://blog.kroy.io/wpautoterms/privacy-policy/">Privacy Policy</a><span class="separator"> - </span><a href="https://blog.kroy.io/wpautoterms/terms-and-conditions/">Terms and Conditions</a></p>
</div>
</body></html>
