<!DOCTYPE html>
<html lang="en-US" itemscope itemtype="http://schema.org/WebPage"><head><meta charset="UTF-8"><title>Building a ZFS on Linux Fileserver – blog.kroy.io</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="dns-prefetch" href="//s.w.org"><script type="text/javascript" data-cfasync="false">
    (window.gaDevIds=window.gaDevIds||[]).push("dNDMyYj");
	var em_version         = '6.3.0';
	var em_track_user      = true;
	var em_no_track_reason = '';
	
	var disableStr = 'ga-disable-UA-89722449-1';

	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}

	if ( 'undefined' === typeof gaOptout ) {
		function gaOptout() {
			__gaTrackerOptout();
		}
	}
	
	if ( em_track_user ) {
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

window.ga = __gaTracker;		__gaTracker('create', 'UA-89722449-1', 'auto');
		__gaTracker('set', 'forceSSL', true);
		__gaTracker('send','pageview');
		__gaTracker( function() { window.ga = __gaTracker; } );
	} else {
		console.log( "" );
		(function() {
			/* https://developers.google.com/analytics/devguides/collection/analyticsjs/ */
			var noopfn = function() {
				return null;
			};
			var noopnullfn = function() {
				return null;
			};
			var Tracker = function() {
				return null;
			};
			var p = Tracker.prototype;
			p.get = noopfn;
			p.set = noopfn;
			p.send = noopfn;
			var __gaTracker = function() {
				var len = arguments.length;
				if ( len === 0 ) {
					return;
				}
				var f = arguments[len-1];
				if ( typeof f !== 'object' || f === null || typeof f.hitCallback !== 'function' ) {
					console.log( 'Not running function __gaTracker(' + arguments[0] + " ....) because you are not being tracked. " + em_no_track_reason );
					return;
				}
				try {
					f.hitCallback();
				} catch (ex) {

				}
			};
			__gaTracker.create = function() {
				return new Tracker();
			};
			__gaTracker.getByName = noopnullfn;
			__gaTracker.getAll = function() {
				return [];
			};
			__gaTracker.remove = noopfn;
			window['__gaTracker'] = __gaTracker;
			window.ga = __gaTracker;		})();
		}
</script><style type="text/css" media="all">
.wpautoterms-footer{background-color:#ffffff;text-align:center;}
.wpautoterms-footer a{color:#000000;font-family:Arial, sans-serif;font-size:14px;}
.wpautoterms-footer .separator{color:#cccccc;font-family:Arial, sans-serif;font-size:14px;}</style><link rel="stylesheet" id="wp-block-library-css" href="https://blog.kroy.io/wp-includes/css/dist/block-library/style.min.css" media="all"><style id="wp-block-library-inline-css">
.has-text-align-justify{text-align:justify;}
</style><link rel="stylesheet" id="wp-block-library-theme-css" href="https://blog.kroy.io/wp-includes/css/dist/block-library/theme.min.css" media="all"><link rel="stylesheet" id="wpautoterms_css-css" href="https://blog.kroy.io/wp-content/plugins/auto-terms-of-service-and-privacy-policy/css/wpautoterms.css" media="all"><link rel="stylesheet" id="SFSImainCss-css" href="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/css/sfsi-style.css" media="all"><link rel="stylesheet" id="disable_sfsi-css" href="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/css/disable_sfsi.css" media="all"><link rel="stylesheet" id="exactmetrics-popular-posts-style-css" href="https://blog.kroy.io/wp-content/plugins/google-analytics-dashboard-for-wp/assets/css/frontend.min.css" media="all"><link rel="stylesheet" id="sinatra-styles-css" href="https://blog.kroy.io/wp-content/themes/sinatra/assets/css/style.min.css" media="all"><link rel="stylesheet" id="sinatra-dynamic-styles-css" href="https://blog.kroy.io/wp-content/uploads/sinatra/dynamic-styles.css" media="all"><link rel="stylesheet" id="jetpack_css-css" href="https://blog.kroy.io/wp-content/plugins/jetpack/css/jetpack.css" media="all"><script src="https://blog.kroy.io/wp-includes/js/jquery/jquery.js" id="jquery-core-js"></script><script src="https://blog.kroy.io/wp-includes/js/dist/vendor/wp-polyfill.min.js" id="wp-polyfill-js"></script><script id="wp-polyfill-js-after">
( 'fetch' in window ) || document.write( '<script src="https://blog.kroy.io/wp-includes/js/dist/vendor/wp-polyfill-fetch.min.js?ver=3.0.0">' + 'ipt>' );( document.contains ) || document.write( '<script src="https://blog.kroy.io/wp-includes/js/dist/vendor/wp-polyfill-node-contains.min.js?ver=3.42.0">' + 'ipt>' );( window.DOMRect ) || document.write( '<script src="https://blog.kroy.io/wp-includes/js/dist/vendor/wp-polyfill-dom-rect.min.js?ver=3.42.0">' + 'ipt>' );( window.URL && window.URL.prototype && window.URLSearchParams ) || document.write( '<script src="https://blog.kroy.io/wp-includes/js/dist/vendor/wp-polyfill-url.min.js?ver=3.6.4">' + 'ipt>' );( window.FormData && window.FormData.prototype.keys ) || document.write( '<script src="https://blog.kroy.io/wp-includes/js/dist/vendor/wp-polyfill-formdata.min.js?ver=3.0.12">' + 'ipt>' );( Element.prototype.matches && Element.prototype.closest ) || document.write( '<script src="https://blog.kroy.io/wp-includes/js/dist/vendor/wp-polyfill-element-closest.min.js?ver=2.0.2">' + 'ipt>' );
</script><script src="https://blog.kroy.io/wp-includes/js/dist/dom-ready.min.js" id="wp-dom-ready-js"></script><script src="https://blog.kroy.io/wp-content/plugins/auto-terms-of-service-and-privacy-policy/js/base.js" id="wpautoterms_base-js"></script><script id="exactmetrics-frontend-script-js-extra">
var exactmetrics_frontend = {"js_events_tracking":"true","download_extensions":"zip,mp3,mpeg,pdf,docx,pptx,xlsx,rar","inbound_paths":"[{\"path\":\"\\\/go\\\/\",\"label\":\"affiliate\"},{\"path\":\"\\\/recommend\\\/\",\"label\":\"affiliate\"}]","home_url":"https:\/\/PLACEHOLDER.wpsho","hash_tracking":"false"};
</script><script src="https://blog.kroy.io/wp-content/plugins/google-analytics-dashboard-for-wp/assets/js/frontend.min.js" id="exactmetrics-frontend-script-js"></script><script src="https://blog.kroy.io/wp-includes/js/jquery/jquery-migrate.min.js" id="jquery-migrate-js"></script><meta name="follow.it-verification-code-SERxZVdXbkRiWE9LYThHK2pmY09ydUlMSkF3cm9ERmJpV2JlS3p0Z1locmlNWjBFeGZtaFBCMEF4Q1hRblVqN0JUbGFXRXg4Y25yUnpVcFN0TUVQeTdIVUtkT1JVRXg2SXJvYndWbEJhRi9ZenJWdk1XSlc1VWQwQVIvNVY3dWJ8YnBDU2RZbGZvSzFjVlBLVDRjWGYwellwelNqT2ZCQzFzbmp6V24vN0FQOD0=" content="JYtCEsckN2zSqxbf9XAX"><meta name="viewport" content="width=device-width, initial-scale=1"><meta property="og:image:secure_url" content="https://blog.kroy.io/wp-content/uploads/2018/07/login.png" data-id="sfsi"><meta property="og:image:type" content="image/png" data-id="sfsi"><meta property="og:image:width" content="1807" data-id="sfsi"><meta property="og:image:height" content="958" data-id="sfsi"><meta property="og:url" content="https://blog.kroy.io/2018/07/16/building-a-zfs-on-linux-fileserver/" data-id="sfsi"><meta property="og:description" content="
After my recent migration back to ZFS on Linux, I decided to roll my own GUI for server reporting/management.







Unfortunately, as referenced in the above linked post, I recently picked up some 10TB Seagate drives that refuse to be stable in any ZFS array, except on Linux.  It's worth mentioning that running them on Linux seems to be the fix, as they've been 100% stable for weeks now.



While I was a VERY early adopter of ZFS on Linux, in recent years I've avoided it.  I think part of the reason is the lack of a GUI.



While I don't need or want a GUI for configuration, for reporting it's more than helpful.  Scanning lines and lines of text for things like smart status is absolutely no fun.



I've tried OMV, but I really wasn't a fan of the interface.  It ultimately represents a lot of bloat and most of it I don't have much use for.







The Core



At the core of the new system is Debian Stretch.  I initially tried Ubuntu 18.04, but I found NFS on Ubuntu has a problem.  I believe locking to be broken, as I was having problems with Gitlab that has otherwise been running flawlessly over NFS under FreeNAS, OMV, OmniOS CE, and finally bare Debian.  There were also other strange locking issues (with ESXi) that I wasn't able to resolve until switching to Debian (which I guess OMV is).



Other than that, the software stack is simple:



Debian Stretch with backports.  Needed because the ZFS version on Stretch is ancient (.0.6.5).  Backports gets version .0.7.9-3.zfs-zed.  Again from backports.  Allows notification of ZFS events (drive failures, scrubs, etc).sanoid/syncoid.  Simple method of setting up automatic ZFS snapshot management and replication.NFS.  Pretty straightforward.  Despite using NFS for YEARS, I never really understood NFSv4.  I finally took the opportunity to learn how the fsid works.Samba.  Again, straightforward.  I mainly use this for ISOs exports to Supermicro IPMIs and Time Machine.smartmontools.  Smart monitoring for the connected drives.Glaces.  This is a great system monitor that has a wonderful web-based API, needed for tapping into for reporting.LIO for iSCSI.  iSCSI on Linux is... annoying, for reasons I'll mention in a few lines.PHP7.2 (from a PPA), Smarty (php templating system), nginx, and a nice template from Bootstrapmade.  Despite any abilities with code, I am completely unable to make something look appealing.



I don't really have a problem with configuring any of this from the command-line.  Most of the things represent a handful of lines of configuration at most.



LIO is simple enough to use, but it took me some time to figure out WHICH iSCSI implementation I should actually be using.  There are a number of iSCSI implementations on Debian and they are all active and available. The other ones  are mostly maintained for backwards compatibility I think.



The interface for LIO is targetcli, which has a distinct DOS-like feel.  It also supports things like tab-completion, which is helpful if you've never used it before:











The GUI



I've tried (successfully and unsuccessfully) to make web GUIs for server management and reporting in the past.  It's usually not a lot of fun.  The hacks required to pull data from the variety of sources generally just makes for super ugly code.  For this project,  I discovered Glances.



If you've never used Glances before, at its core, it's almost just a top/htop replacement.  But it also provides a nice web interface that is capable of spitting out JSON.







Of course, this makes it disgustingly easy to create a web application that is capable of pulling all manner of statistics.







That means with a few lines of JQuery,







and using that nice template I mentioned, voilà, a simple dashboard:











Disks



A big reason for buildling this application is to easily monitor smart stats and disk health.  Which is something else glances doesn't cover.  I imagine there's a plugin available for it, but it's easy enough to pull and parse smartctl output:







ZFS



Anything ZFS related is outside of the scope of glances.  I did check around for a third-party plugin a bit, but was unable to find anything.  Which means the ARC section:







Needs to come from my own code.  Fortunately, this is data that's easily accessible:







Similar code builds the pool topologies, data structures, health and more from running zpool status/zpool list/etc:







And while sanoid works perfectly, sometimes its nice to be able to visualize snapshots (and remove some manual ones):







The end



In all, I am far more satisfied with this setup than any of the ZFS systems I've run in a long time.  FreeNAS always felt like a crapshoot whether an update was going to implode my setup, and the support was non-existent when something went wrong in OmniOS.



The dashboard in motion
" data-id="sfsi"><meta property="og:title" content="Building a ZFS on Linux Fileserver" data-id="sfsi"><style type="text/css">img#wpstats{display:none}</style><meta name="theme-color" content="#3857F1"><link rel="icon" href="https://blog.kroy.io/wp-content/uploads/2020/04/cropped-android-chrome-512x512-3-32x32.png" sizes="32x32"><link rel="icon" href="https://blog.kroy.io/wp-content/uploads/2020/04/cropped-android-chrome-512x512-3-192x192.png" sizes="192x192"><link rel="apple-touch-icon" href="https://blog.kroy.io/wp-content/uploads/2020/04/cropped-android-chrome-512x512-3-180x180.png"><meta name="msapplication-TileImage" content="https://blog.kroy.io/wp-content/uploads/2020/04/cropped-android-chrome-512x512-3-270x270.png"></head><body class="post-template-default single single-post postid-30 single-format-standard wp-embed-responsive sinatra-topbar__separators-regular sinatra-layout__fw-contained sinatra-with-dropdown-indicators sinatra-header-layout-1 sinatra-menu-animation-underline sinatra-header__separators-none si-single-title-in-content si-page-title-align-left comments-open si-has-sidebar sinatra-sidebar-style-3 sinatra-sidebar-position__right-sidebar si-sidebar-r__after-content entry-media-hover-style-1 sinatra-copyright-layout-1 si-input-supported validate-comment-form si-menu-accessibility">


<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
	<header id="masthead" class="site-header" role="banner" itemtype="https://schema.org/WPHeader" itemscope="itemscope"><div id="sinatra-header">
		<div id="sinatra-header-inner">
	
<div class="si-container si-header-container">

	
<div class="sinatra-logo si-header-element" itemtype="https://schema.org/Organization" itemscope="itemscope">
	<div class="logo-inner"><span class="site-title" itemprop="name">
						<a href="https://blog.kroy.io/" rel="home" itemprop="url">
							blog.kroy.io
						</a>
					</span><p class="site-description" itemprop="description">
						computers, tech, and whatever other random stuff crosses my mind.
					</p></div></div>

<nav class="site-navigation main-navigation sinatra-primary-nav sinatra-nav si-header-element" role="navigation" itemtype="https://schema.org/SiteNavigationElement" itemscope="itemscope" aria-label="Site Navigation"><ul class="sinatra-primary-nav"><li><a href="https://blog.kroy.io/"><span>Home</span></a></li></ul></nav><div class="si-header-widgets si-header-element sinatra-widget-location-right"><div class="si-header-widget__search si-header-widget sinatra-hide-mobile-tablet"><div class="si-widget-wrapper">
<div aria-haspopup="true">
	<a href="#" class="si-search">
		<i class="si-icon si-search"></i>
	</a>

	<div class="si-search-simple si-search-container dropdown-item">
		<form role="search" aria-label="Site Search" method="get" class="si-search-form" action="https://blog.kroy.io/">

			<label class="si-form-label">
				<span class="screen-reader-text">Search for:</span>
				<input type="search" class="si-input-search" placeholder="Search" value="" name="s" autocomplete="off"></label>

			
			<button type="submit" class="sinatra-animate-arrow right-arrow" aria-hidden="true" role="button">
				<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="30px" height="18px" viewbox="0 0 30 18" enable-background="new 0 0 30 18" xml:space="preserve"><path class="arrow-handle" d="M2.511,9.007l7.185-7.221c0.407-0.409,0.407-1.071,0-1.48s-1.068-0.409-1.476,0L0.306,8.259 c-0.408,0.41-0.408,1.072,0,1.481l7.914,7.952c0.407,0.408,1.068,0.408,1.476,0s0.407-1.07,0-1.479L2.511,9.007z"></path><path class="arrow-bar" fill-rule="evenodd" clip-rule="evenodd" d="M1,8h28.001c0.551,0,1,0.448,1,1c0,0.553-0.449,1-1,1H1c-0.553,0-1-0.447-1-1
					                            C0,8.448,0.447,8,1,8z"></path></svg></button>
		</form>
	</div>
</div>
</div></div></div>
	<span class="si-header-element si-mobile-nav">
				<button class="si-hamburger hamburger--spin si-hamburger-sinatra-primary-nav" aria-label="Menu" aria-controls="sinatra-primary-nav" type="button">

			
			<span class="hamburger-box">
				<span class="hamburger-inner"></span>
			</span>

		</button>
			</span>

</div>
	</div>
	</div>
		
<div class="page-header si-has-breadcrumbs">

	
	
	<div class="si-container si-breadcrumbs"><nav role="navigation" aria-label="Breadcrumbs" class="breadcrumb-trail breadcrumbs" itemprop="breadcrumb"><ul class="trail-items" itemscope itemtype="http://schema.org/BreadcrumbList"><meta name="numberOfItems" content="5"><meta name="itemListOrder" content="Ascending"><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item trail-begin"><a href="https://blog.kroy.io/" rel="home" itemprop="item"><span itemprop="name">Home</span></a><meta itemprop="position" content="1"></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item"><a href="https://blog.kroy.io/2018/" itemprop="item"><span itemprop="name">2018</span></a><meta itemprop="position" content="2"></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item"><a href="https://blog.kroy.io/2018/07/" itemprop="item"><span itemprop="name">July</span></a><meta itemprop="position" content="3"></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item"><a href="https://blog.kroy.io/2018/07/16/" itemprop="item"><span itemprop="name">16</span></a><meta itemprop="position" content="4"></li><li itemprop="itemListElement" itemscope itemtype="http://schema.org/ListItem" class="trail-item trail-end"><span><span itemprop="name">Building a ZFS on Linux Fileserver</span></span><meta itemprop="position" content="5"></li></ul></nav></div>
</div>
	</header><div id="main" class="site-main">

		
<div class="si-container">

	<div id="primary" class="content-area">

		
		<main id="content" class="site-content" role="main" itemscope itemtype="http://schema.org/Blog"><article id="post-30" class="sinatra-article post-30 post type-post status-publish format-standard has-post-thumbnail hentry category-homelab category-zfs" itemscope="" itemtype="https://schema.org/CreativeWork"><div class="post-category">

	<span class="cat-links"><span class="screen-reader-text">Posted in</span><span><a href="https://blog.kroy.io/category/homelab/" rel="category tag">HomeLab</a> <a href="https://blog.kroy.io/category/zfs/" rel="category tag">ZFS</a></span></span>
</div>

<header class="entry-header"><h1 class="entry-title" itemprop="headline">
		Building a ZFS on Linux Fileserver	</h1>

</header><div class="entry-meta"><div class="entry-meta-elements">		<span class="post-author">
			<span class="posted-by vcard author" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person">
				<span class="screen-reader-text">Posted by</span>

				
				<span>
										By 					<a class="url fn n" title="View all posts by Kroy" href="https://blog.kroy.io/author/kroy3348/" rel="author" itemprop="url">
						<span class="author-name" itemprop="name">Kroy</span>
					</a>
				</span>
			</span>
		</span>
		<span class="posted-on">July 16, 2018</span><span class="comments-link"><a href="https://blog.kroy.io/2018/07/16/building-a-zfs-on-linux-fileserver/#respond" class="comments-link">No Comments</a></span></div></div><div class="post-thumb entry-media thumbnail"><img width="1024" height="543" src="https://blog.kroy.io/wp-content/uploads/2018/07/login-1024x543.png" class="attachment-large size-large wp-post-image" alt="loginpage" loading="lazy"></div>
<div class="entry-content si-entry" itemprop="text">
	
<p>After my <a href="/the-zfs-walk-of-shame-with-seagate-and-omnios-ce/">recent migration</a> back to ZFS on Linux, I decided to roll my own GUI for server reporting/management.</p>



<hr class="wp-block-separator"><p>Unfortunately, as referenced in the above linked post, I recently picked up some 10TB Seagate drives that refuse to be stable in any ZFS array, except on Linux.  It’s worth mentioning that running them on Linux seems to be the fix, as they’ve been 100% stable for weeks now.</p>



<p>While I was a VERY early adopter of ZFS on Linux, in recent years I’ve avoided it.  I think part of the reason is the lack of a GUI.</p>



<p>While I don’t need or want a GUI for configuration, for reporting it’s more than helpful.  Scanning lines and lines of text for things like smart status is absolutely no fun.</p>



<p>I’ve tried OMV, but I really wasn’t a fan of the interface.  It ultimately represents a lot of bloat and most of it I don’t have much use for.</p>



<hr class="wp-block-separator"><h1 id="thecore">The Core</h1>



<p>At the core of the new system is Debian Stretch.  I initially tried Ubuntu 18.04, but I found NFS on Ubuntu has a problem.  I believe locking to be broken, as I was having problems with Gitlab that has otherwise been running flawlessly over NFS under FreeNAS, OMV, OmniOS CE, and finally bare Debian.  There were also other strange locking issues (with ESXi) that I wasn’t able to resolve until switching to Debian (which I guess OMV is).</p>



<p>Other than that, the software stack is simple:</p>



<ul><li>Debian Stretch with backports.  Needed because the ZFS version on Stretch is ancient (.0.6.5).  Backports gets version .0.7.9-3.</li><li>zfs-zed.  Again from backports.  Allows notification of ZFS events (drive failures, scrubs, etc).</li><li><a href="https://github.com/jimsalterjrs/sanoid">sanoid/syncoid</a>.  Simple method of setting up automatic ZFS snapshot management and replication.</li><li>NFS.  Pretty straightforward.  Despite using NFS for YEARS, I never really understood NFSv4.  I finally took the opportunity to learn how the <code>fsid</code> works.</li><li>Samba.  Again, straightforward.  I mainly use this for ISOs exports to Supermicro IPMIs and Time Machine.</li><li>smartmontools.  Smart monitoring for the connected drives.</li><li>Glaces.  This is a great system monitor that has a wonderful web-based API, needed for tapping into for reporting.</li><li>LIO for iSCSI.  iSCSI on Linux is… annoying, for reasons I’ll mention in a few lines.</li><li>PHP7.2 (from a PPA), Smarty (php templating system), nginx, and a nice template from <a href="https://bootstrapmade.com/">Bootstrapmade</a>.  Despite any abilities with code, I am completely unable to make something look appealing.</li></ul><p>I don’t really have a problem with configuring any of this from the command-line.  Most of the things represent a handful of lines of configuration at most.</p>



<p>LIO is simple enough to use, but it took me some time to figure out WHICH iSCSI implementation I should actually be using.  There are a number of iSCSI implementations on Debian and they are all active and available. The other ones  are mostly maintained for backwards compatibility I think.</p>



<p>The interface for LIO is targetcli, which has a distinct DOS-like feel.  It also supports things like tab-completion, which is helpful if you’ve never used it before:</p>



<figure class="wp-block-image"><img loading="lazy" width="836" height="597" src="https://blog2.kroy.io/wp-content/uploads/2019/08/lio-1.png" alt="" class="wp-image-63" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/lio-1.png 836w,https://blog.kroy.io/wp-content/uploads/2019/08/lio-1-300x214.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/lio-1-768x548.png 768w" sizes="(max-width: 836px) 100vw, 836px"></figure><hr class="wp-block-separator"><h1 id="thegui">The GUI</h1>



<p>I’ve tried (successfully and unsuccessfully) to make web GUIs for server management and reporting in the past.  It’s usually not a lot of fun.  The hacks required to pull data from the variety of sources generally just makes for super ugly code.  For this project,  I discovered Glances.</p>



<p>If you’ve never used Glances before, at its core, it’s almost just a “top/htop” replacement.  But it also provides a nice web interface that is capable of spitting out JSON.</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="134" src="https://blog2.kroy.io/wp-content/uploads/2019/08/glances-1024x134.png" alt="" class="wp-image-64" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/glances-1024x134.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/glances-300x39.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/glances-768x101.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/glances-850x112.png 850w,https://blog.kroy.io/wp-content/uploads/2019/08/glances.png 1790w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p>Of course, this makes it disgustingly easy to create a web application that is capable of pulling all manner of statistics.</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="79" src="https://blog2.kroy.io/wp-content/uploads/2019/08/glances_api-1024x79.png" alt="" class="wp-image-65" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/glances_api-1024x79.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/glances_api-300x23.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/glances_api-768x60.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/glances_api-850x66.png 850w,https://blog.kroy.io/wp-content/uploads/2019/08/glances_api.png 1792w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p>That means with a few lines of JQuery,</p>



<figure class="wp-block-image"><img loading="lazy" width="879" height="673" src="https://blog2.kroy.io/wp-content/uploads/2019/08/glances_js_api.png" alt="" class="wp-image-66" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/glances_js_api.png 879w,https://blog.kroy.io/wp-content/uploads/2019/08/glances_js_api-300x230.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/glances_js_api-768x588.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/glances_js_api-850x651.png 850w" sizes="(max-width: 879px) 100vw, 879px"></figure><p>and using that nice template I mentioned, voilà, a simple dashboard:</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="698" src="https://blog2.kroy.io/wp-content/uploads/2019/08/dashboard_10gb-1024x698.png" alt="" class="wp-image-67" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_10gb-1024x698.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_10gb-300x204.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_10gb-768x523.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_10gb-850x579.png 850w,https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_10gb.png 1312w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><figure class="wp-block-image"><img loading="lazy" width="1024" height="689" src="https://blog2.kroy.io/wp-content/uploads/2019/08/dashboard_cpu-1-1024x689.png" alt="" class="wp-image-68" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_cpu-1-1024x689.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_cpu-1-300x202.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_cpu-1-768x517.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_cpu-1-850x572.png 850w,https://blog.kroy.io/wp-content/uploads/2019/08/dashboard_cpu-1.png 1423w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><h3 id="disks">Disks</h3>



<p>A big reason for buildling this application is to easily monitor smart stats and disk health.  Which is something else glances doesn’t cover.  I imagine there’s a plugin available for it, but it’s easy enough to pull and parse smartctl output:</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="767" src="https://blog2.kroy.io/wp-content/uploads/2019/08/drives-1024x767.png" alt="" class="wp-image-69" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/drives-1024x767.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/drives-300x225.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/drives-768x576.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/drives-850x637.png 850w,https://blog.kroy.io/wp-content/uploads/2019/08/drives.png 1461w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><h3 id="zfs">ZFS</h3>



<p>Anything ZFS related is outside of the scope of glances.  I did check around for a third-party plugin a bit, but was unable to find anything.  Which means the ARC section:</p>



<figure class="wp-block-image"><img loading="lazy" width="273" height="254" src="https://blog2.kroy.io/wp-content/uploads/2019/08/arc.png" alt="" class="wp-image-70"></figure><p>Needs to come from my own code.  Fortunately, this is data that’s easily accessible:</p>



<figure class="wp-block-image"><img loading="lazy" width="649" height="401" src="https://blog2.kroy.io/wp-content/uploads/2019/08/arc_code.png" alt="" class="wp-image-71" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/arc_code.png 649w,https://blog.kroy.io/wp-content/uploads/2019/08/arc_code-300x185.png 300w" sizes="(max-width: 649px) 100vw, 649px"></figure><p>Similar code builds the pool topologies, data structures, health and more from running <code>zpool status</code>/<code>zpool list</code>/etc:</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="628" src="https://blog2.kroy.io/wp-content/uploads/2019/08/zfspool-1024x628.png" alt="" class="wp-image-72" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/zfspool-1024x628.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/zfspool-300x184.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/zfspool-768x471.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/zfspool-850x521.png 850w,https://blog.kroy.io/wp-content/uploads/2019/08/zfspool.png 1469w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><p>And while sanoid works perfectly, sometimes its nice to be able to visualize snapshots (and remove some manual ones):</p>



<figure class="wp-block-image"><img loading="lazy" width="1024" height="721" src="https://blog2.kroy.io/wp-content/uploads/2019/08/zfssnapshots-1024x721.png" alt="" class="wp-image-73" srcset="https://blog.kroy.io/wp-content/uploads/2019/08/zfssnapshots-1024x721.png 1024w,https://blog.kroy.io/wp-content/uploads/2019/08/zfssnapshots-300x211.png 300w,https://blog.kroy.io/wp-content/uploads/2019/08/zfssnapshots-768x541.png 768w,https://blog.kroy.io/wp-content/uploads/2019/08/zfssnapshots-850x599.png 850w,https://blog.kroy.io/wp-content/uploads/2019/08/zfssnapshots.png 1440w" sizes="(max-width: 1024px) 100vw, 1024px"></figure><h2 id="theend">The end</h2>



<p>In all, I am far more satisfied with this setup than any of the ZFS systems I’ve run in a long time.  FreeNAS always felt like a crapshoot whether an update was going to implode my setup, and the support was non-existent when something went wrong in OmniOS.</p>



<p><a href="https://gfycat.com/ifr/DesertedEsteemedIcterinewarbler">The dashboard in motion</a></p>
<div class="sfsi_responsive_icons" style="display:inline-block;margin-top:0px; margin-bottom: 0px; width:100%" data-icon-width-type="Fully responsive" data-icon-width-size="240" data-edge-type="Round" data-edge-radius="5">		<div class="sfsi_responsive_icons_count sfsi_responsive_count_container sfsi_medium_button" style="display:none;text-align:center; background-color:#fff;color:#aaaaaa;  border-radius:5px; ;">
			<h3 style="color:#aaaaaa; ">60</h3>
			<h6 style="color:#aaaaaa;">SHARES</h6>
		</div>
		<div class="sfsi_icons_container sfsi_responsive_without_counter_icons sfsi_medium_button_container sfsi_icons_container_box_fully_container " style="width:100%;display:flex; ; text-align:center;">		<a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.kroy.io%2F2018%2F07%2F16%2Fbuilding-a-zfs-on-linux-fileserver%2F" style="display:block;text-align:center;margin-left:10px;  flex-basis:100%;" class="sfsi_responsive_fluid">
			<div class="sfsi_responsive_icon_item_container sfsi_responsive_icon_facebook_container sfsi_medium_button sfsi_responsive_icon_gradient sfsi_centered_icon" style=" border-radius:5px;  width:100%; ">
				<img style="max-height: 25px;display:unset;margin:0" class="sfsi_wicon" alt="facebook" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/responsive-icon/facebook.svg"><span style="color:#fff">Share on Facebook</span>
			</div>
		</a>

		<a target="_blank" href="https://twitter.com/intent/tweet?text=Hey%2C+check+out+this+cool+site+I+found%3A+www.yourname.com+%23Topic+via%40my_twitter_name&url=https%3A%2F%2Fblog.kroy.io%2F2018%2F07%2F16%2Fbuilding-a-zfs-on-linux-fileserver%2F" style="display:block;text-align:center;margin-left:10px;  flex-basis:100%;" class="sfsi_responsive_fluid">
			<div class="sfsi_responsive_icon_item_container sfsi_responsive_icon_twitter_container sfsi_medium_button sfsi_responsive_icon_gradient sfsi_centered_icon" style=" border-radius:5px;  width:100%; ">
				<img style="max-height: 25px;display:unset;margin:0" class="sfsi_wicon" alt="Twitter" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/responsive-icon/Twitter.svg"><span style="color:#fff">Tweet</span>
			</div>
		</a>

		<a target="_blank" href="https://api.follow.it/widgets/icon/SERxZVdXbkRiWE9LYThHK2pmY09ydUlMSkF3cm9ERmJpV2JlS3p0Z1locmlNWjBFeGZtaFBCMEF4Q1hRblVqN0JUbGFXRXg4Y25yUnpVcFN0TUVQeTdIVUtkT1JVRXg2SXJvYndWbEJhRi9ZenJWdk1XSlc1VWQwQVIvNVY3dWJ8YnBDU2RZbGZvSzFjVlBLVDRjWGYwellwelNqT2ZCQzFzbmp6V24vN0FQOD0=/OA==/" style="display:block;text-align:center;margin-left:10px;  flex-basis:100%;" class="sfsi_responsive_fluid">
			<div class="sfsi_responsive_icon_item_container sfsi_responsive_icon_follow_container sfsi_medium_button sfsi_responsive_icon_gradient sfsi_centered_icon" style=" border-radius:5px;  width:100%; ">
				<img style="max-height: 25px;display:unset;margin:0" class="sfsi_wicon" alt="Follow" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/responsive-icon/Follow.png"><span style="color:#fff">Follow us</span>
			</div>
		</a>

		<a target="_blank" href="" style="display:none;text-align:center;margin-left:10px;  flex-basis:100%;" class="sfsi_responsive_fluid">
			<div class="sfsi_responsive_icon_item_container sfsi_responsive_custom_icon sfsi_responsive_icon_0_container sfsi_medium_button sfsi_centered_icon sfsi_responsive_icon_gradient" style=" border-radius:5px;  width:100%; background-color:#729fcf">
				<img style="max-height: 25px" alt="custom" src=""><span style="color:#fff">Share</span>
			</div>
		</a>

		<a target="_blank" href="" style="display:none;text-align:center;margin-left:10px;  flex-basis:100%;" class="sfsi_responsive_fluid">
			<div class="sfsi_responsive_icon_item_container sfsi_responsive_custom_icon sfsi_responsive_icon_1_container sfsi_medium_button sfsi_centered_icon sfsi_responsive_icon_gradient" style=" border-radius:5px;  width:100%; background-color:#729fcf">
				<img style="max-height: 25px" alt="custom" src=""><span style="color:#fff">Share</span>
			</div>
		</a>

		<a target="_blank" href="" style="display:none;text-align:center;margin-left:10px;  flex-basis:100%;" class="sfsi_responsive_fluid">
			<div class="sfsi_responsive_icon_item_container sfsi_responsive_custom_icon sfsi_responsive_icon_2_container sfsi_medium_button sfsi_centered_icon sfsi_responsive_icon_gradient" style=" border-radius:5px;  width:100%; background-color:#729fcf">
				<img style="max-height: 25px" alt="custom" src=""><span style="color:#fff">Share</span>
			</div>
		</a>

		<a target="_blank" href="" style="display:none;text-align:center;margin-left:10px;  flex-basis:100%;" class="sfsi_responsive_fluid">
			<div class="sfsi_responsive_icon_item_container sfsi_responsive_custom_icon sfsi_responsive_icon_3_container sfsi_medium_button sfsi_centered_icon sfsi_responsive_icon_gradient" style=" border-radius:5px;  width:100%; background-color:#729fcf">
				<img style="max-height: 25px" alt="custom" src=""><span style="color:#fff">Share</span>
			</div>
		</a>

		<a target="_blank" href="" style="display:none;text-align:center;margin-left:10px;  flex-basis:100%;" class="sfsi_responsive_fluid">
			<div class="sfsi_responsive_icon_item_container sfsi_responsive_custom_icon sfsi_responsive_icon_4_container sfsi_medium_button sfsi_centered_icon sfsi_responsive_icon_gradient" style=" border-radius:5px;  width:100%; background-color:#729fcf">
				<img style="max-height: 25px" alt="custom" src=""><span style="color:#fff">Share</span>
			</div>
		</a>

</div></div></div>




<div class="entry-footer">

	<span class="last-updated">Last updated on August 29, 2019</span>
</div>


<section class="author-box" itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><div class="author-box-avatar">
		<img alt="" src="https://secure.gravatar.com/avatar/347d9cf482cfe91444ae0d59550ad83c?s=75&d=mm&r=g" srcset="https://secure.gravatar.com/avatar/347d9cf482cfe91444ae0d59550ad83c?s=150&d=mm&r=g 2x" class="avatar avatar-75 photo" height="75" width="75" loading="lazy"></div>

	<div class="author-box-meta">
		<h4 class="author-box-title">
							<a href="https://blog.kroy.io/author/kroy3348/" class="url fn n" rel="author" itemprop="url">
				Kroy	
				</a>
						</h4>

		
		
		<div class="author-box-content" itemprop="description">
			sometimes hacker of things and other things...		</div>

		
<div class="more-posts-button">
	<a href="https://blog.kroy.io/author/kroy3348/" class="si-btn btn-text-1" role="button"><span>View All Posts</span></a>
</div>
	</div>

</section><section class="post-nav" role="navigation"><h2 class="screen-reader-text">Post navigation</h2>

	<div class="nav-previous"><h6 class="nav-title">Previous Post</h6><a href="https://blog.kroy.io/2018/07/07/the-zfs-walk-of-shame-with-seagate-and-omnios-ce/" rel="prev"><div class="nav-content"><img width="75" height="75" src="https://blog.kroy.io/wp-content/uploads/2018/07/photo-1531570325967-4b8fcb7e120d-150x150.jpg" class="attachment-75x75 size-75x75 wp-post-image" alt="i-am-a-monkey" loading="lazy" itemprop="image"><span>The ZFS walk-of-shame with Seagate and OmniOS CE.</span></div></a></div><div class="nav-next"><h6 class="nav-title">Next Post</h6><a href="https://blog.kroy.io/2018/11/14/lets-run-with-routing-part-1/" rel="next"><div class="nav-content"><span>Let’s Play with Routing – Part 1</span> <img width="75" height="75" src="https://blog.kroy.io/wp-content/uploads/2018/11/photo-1474314243412-cd4a79f02c6a-150x150.jpg" class="attachment-75x75 size-75x75 wp-post-image" alt="electricity-routing" loading="lazy" itemprop="image"></div></a></div>
</section></article><section id="comments" class="comments-area"><div class="comments-title-wrapper center-text">
		<h3 class="comments-title">
			Comments		</h3>

					<p class="no-comments">No comments yet. Why don’t you start the discussion?</p>
			</div>

	<ol class="comment-list"></ol><div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2018/07/16/building-a-zfs-on-linux-fileserver/#respond" style="display:none;">Cancel reply</a></small></h3><form action="https://blog.kroy.io/wp-comments-post.php" method="post" id="commentform" class="comment-form"><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-textarea"><textarea name="comment" id="comment" cols="44" rows="8" class="textarea-comment" placeholder="Write a comment…" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"><label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><span class="sinatra-submit-form-button"><input name="submit" type="submit" id="comment-submit" class="si-btn primary-button" value="Post Comment"></span> <input type="hidden" name="comment_post_ID" value="30" id="comment_post_ID"><input type="hidden" name="comment_parent" id="comment_parent" value="0"></p></form>	</div>
	
</section></main></div>

	
<aside id="secondary" class="widget-area si-sidebar-container" itemtype="http://schema.org/WPSideBar" itemscope="itemscope" role="complementary"><div class="si-sidebar-inner">
		
		
		<div id="recent-posts-2" class="si-sidebar-widget si-widget si-entry widget widget_recent_entries">
		<h4 class="widget-title">Recent Posts</h4>
		<ul><li>
					<a href="https://blog.kroy.io/2020/11/03/esxi-to-libvirt-now-with-more-terraform/">ESXi to Libvirt, now with more Terraform.</a>
									</li>
											<li>
					<a href="https://blog.kroy.io/2020/05/04/vyos-from-scratch-edition-1/">VyOS from Scratch – Edition 1</a>
									</li>
											<li>
					<a href="https://blog.kroy.io/2020/01/17/the-baby-wyse-the-dell-3040/">A Baby WYSE, the 3040</a>
									</li>
											<li>
					<a href="https://blog.kroy.io/2019/12/08/the-wyse-5070-a-perfect-little-vyos-device/">The WYSE 5070, a perfect little VyOS device</a>
									</li>
											<li>
					<a href="https://blog.kroy.io/2019/11/21/battle-of-the-bare-metal-routers/">Battle of the Bare Metal Routers</a>
									</li>
					</ul></div><div id="archives-2" class="si-sidebar-widget si-widget si-entry widget widget_archive"><h4 class="widget-title">Archives</h4>
			<ul><li><a href="https://blog.kroy.io/2020/11/">November 2020</a></li>
	<li><a href="https://blog.kroy.io/2020/05/">May 2020</a></li>
	<li><a href="https://blog.kroy.io/2020/01/">January 2020</a></li>
	<li><a href="https://blog.kroy.io/2019/12/">December 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/11/">November 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/10/">October 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/09/">September 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/08/">August 2019</a></li>
	<li><a href="https://blog.kroy.io/2019/01/">January 2019</a></li>
	<li><a href="https://blog.kroy.io/2018/11/">November 2018</a></li>
	<li><a href="https://blog.kroy.io/2018/07/">July 2018</a></li>
	<li><a href="https://blog.kroy.io/2018/05/">May 2018</a></li>
	<li><a href="https://blog.kroy.io/2017/12/">December 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/08/">August 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/07/">July 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/06/">June 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/05/">May 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/04/">April 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/03/">March 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/02/">February 2017</a></li>
	<li><a href="https://blog.kroy.io/2017/01/">January 2017</a></li>
			</ul></div><div id="categories-2" class="si-sidebar-widget si-widget si-entry widget widget_categories"><h4 class="widget-title">Categories</h4>
			<ul><li class="cat-item cat-item-39"><a href="https://blog.kroy.io/category/automation/">Automation</a>
</li>
	<li class="cat-item cat-item-12"><a href="https://blog.kroy.io/category/ceph/">ceph</a>
</li>
	<li class="cat-item cat-item-19"><a href="https://blog.kroy.io/category/debian/">Debian</a>
</li>
	<li class="cat-item cat-item-22"><a href="https://blog.kroy.io/category/docker/">Docker</a>
</li>
	<li class="cat-item cat-item-24"><a href="https://blog.kroy.io/category/virtualization/esxi/">ESXi</a>
</li>
	<li class="cat-item cat-item-7"><a href="https://blog.kroy.io/category/freenas/">freenas</a>
</li>
	<li class="cat-item cat-item-26"><a href="https://blog.kroy.io/category/hardware/">Hardware</a>
</li>
	<li class="cat-item cat-item-29"><a href="https://blog.kroy.io/category/hardware-hacks/">Hardware Hacks</a>
</li>
	<li class="cat-item cat-item-4"><a href="https://blog.kroy.io/category/homelab/">HomeLab</a>
</li>
	<li class="cat-item cat-item-38"><a href="https://blog.kroy.io/category/virtualization/kvm/">KVM</a>
</li>
	<li class="cat-item cat-item-2"><a href="https://blog.kroy.io/category/mediaserver/">mediaserver</a>
</li>
	<li class="cat-item cat-item-15"><a href="https://blog.kroy.io/category/mikrotik/">mikrotik</a>
</li>
	<li class="cat-item cat-item-20"><a href="https://blog.kroy.io/category/networking/">Networking</a>
</li>
	<li class="cat-item cat-item-8"><a href="https://blog.kroy.io/category/nucnucnuc/">nucnucnuc</a>
</li>
	<li class="cat-item cat-item-9"><a href="https://blog.kroy.io/category/pfsense/">pfsense</a>
</li>
	<li class="cat-item cat-item-11"><a href="https://blog.kroy.io/category/proxmox/">proxmox</a>
</li>
	<li class="cat-item cat-item-25"><a href="https://blog.kroy.io/category/virtualization/proxmox-virtualization/">Proxmox</a>
</li>
	<li class="cat-item cat-item-13"><a href="https://blog.kroy.io/category/qnap/">QNAP</a>
</li>
	<li class="cat-item cat-item-31"><a href="https://blog.kroy.io/category/homelab/rack-migration/">Rack Migration</a>
</li>
	<li class="cat-item cat-item-14"><a href="https://blog.kroy.io/category/routeros/">RouterOS</a>
</li>
	<li class="cat-item cat-item-18"><a href="https://blog.kroy.io/category/routing/" title="Stuff about routing">Routing</a>
</li>
	<li class="cat-item cat-item-21"><a href="https://blog.kroy.io/category/rtlsdr/">RTLSDR</a>
</li>
	<li class="cat-item cat-item-30"><a href="https://blog.kroy.io/category/storage/">Storage</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://blog.kroy.io/category/sysadmin/">SysAdmin</a>
</li>
	<li class="cat-item cat-item-40"><a href="https://blog.kroy.io/category/automation/terraform/">Terraform</a>
</li>
	<li class="cat-item cat-item-46"><a href="https://blog.kroy.io/category/ubuntu/">Ubuntu</a>
</li>
	<li class="cat-item cat-item-23"><a href="https://blog.kroy.io/category/virtualization/">Virtualization</a>
</li>
	<li class="cat-item cat-item-16"><a href="https://blog.kroy.io/category/vyos/">VyOS</a>
</li>
	<li class="cat-item cat-item-5"><a href="https://blog.kroy.io/category/zfs/">ZFS</a>
</li>
			</ul></div><div id="meta-2" class="si-sidebar-widget si-widget si-entry widget widget_meta"><h4 class="widget-title">Meta</h4>
		<ul><li><a href="https://blog.kroy.io/wp-login.php">Log in</a></li>
			<li><a href="https://blog.kroy.io/feed/">Entries feed</a></li>
			<li><a href="https://blog.kroy.io/comments/feed/">Comments feed</a></li>

			<li><a href="https://wordpress.org/">WordPress.org</a></li>
		</ul></div><div id="custom_html-2" class="widget_text si-sidebar-widget si-widget si-entry widget widget_custom_html"><div class="textwidget custom-html-widget"><div id="amzn-assoc-ad-96eac8be-1743-4b44-98e2-f274484e1cac"></div><script async src="//z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US&adInstanceId=96eac8be-1743-4b44-98e2-f274484e1cac"></script></div></div>
			</div>

</aside></div>

		
	</div>
	
	
			<footer id="colophon" class="site-footer" role="contentinfo" itemtype="http://schema.org/WPFooter" itemscope="itemscope"><div id="sinatra-copyright" class="contained-separator">
	<div class="si-container">
		<div class="si-flex-row">

			<div class="col-xs-12 center-xs col-md flex-basis-auto start-md"><div class="si-copyright-widget__text si-copyright-widget sinatra-all"><span>Copyright 2020 — blog.kroy.io. All rights reserved. <a href="https://wordpress.org/themes/sinatra/" class="imprint" target="_blank" rel="noopener noreferrer">Sinatra WordPress Theme</a></span></div></div>
			<div class="col-xs-12 center-xs col-md flex-basis-auto end-md"></div>

		</div>
	</div>
</div>

		</footer></div>

<a href="#" id="si-scroll-top" class="si-smooth-scroll" title="Scroll to Top">
	<span class="si-scroll-icon" aria-hidden="true">
		<i class="si-icon si-chevron-up top-icon"></i>
		<i class="si-icon si-chevron-up"></i>
	</span>
	<span class="screen-reader-text">Scroll to Top</span>
</a>
			
			<div id="fb-root"></div>
			<script>
				(function(d, s, id) {
					var js, fjs = d.getElementsByTagName(s)[0];
					if (d.getElementById(id)) return;
					js = d.createElement(s);
					js.id = id;
					js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.5";
					fjs.parentNode.insertBefore(js, fjs);
				}(document, 'script', 'facebook-jssdk'));
			</script><script>
window.addEventListener('sfsi_functions_loaded', function() {
    if (typeof sfsi_responsive_toggle == 'function') {
        sfsi_responsive_toggle(0);
        // console.log('sfsi_responsive_toggle');

    }
})
</script><style type="text/css">#sfsi_floater { margin-right:0px; }</style><div class="norm_row sfsi_wDiv" id="sfsi_floater" style="z-index: 9999;width:225px;text-align:left;position:absolute;position:absolute;right:30px;top:50%"><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="" target="_blank" href="https://blog.kroy.io/feed/" id="sfsiid_rss" style="opacity:1"><img data-pin-nopin="true" alt="RSS" title="RSS" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/default/default_rss.png" width="40" height="40" style="" class="sfcm sfsi_wicon " data-effect=""></a></div></div><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="" target="_blank" href="https://api.follow.it/widgets/icon/SERxZVdXbkRiWE9LYThHK2pmY09ydUlMSkF3cm9ERmJpV2JlS3p0Z1locmlNWjBFeGZtaFBCMEF4Q1hRblVqN0JUbGFXRXg4Y25yUnpVcFN0TUVQeTdIVUtkT1JVRXg2SXJvYndWbEJhRi9ZenJWdk1XSlc1VWQwQVIvNVY3dWJ8YnBDU2RZbGZvSzFjVlBLVDRjWGYwellwelNqT2ZCQzFzbmp6V24vN0FQOD0=/OA==/" id="sfsiid_email" style="opacity:1"><img data-pin-nopin="true" alt="Follow by Email" title="Follow by Email" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/default/default_email.png" width="40" height="40" style="" class="sfcm sfsi_wicon " data-effect=""></a></div></div><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="" target="_blank" href="" id="sfsiid_facebook" style="opacity:1"><img data-pin-nopin="true" alt="Facebook" title="Facebook" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/default/default_facebook.png" width="40" height="40" style="" class="sfcm sfsi_wicon " data-effect=""></a><div class="sfsi_tool_tip_2 fb_tool_bdr sfsiTlleft" style="width:62px ;opacity:0;z-index:-1;margin-left:-47.5px;" id="sfsiid_facebook"><span class="bot_arow bot_fb_arow"></span><div class="sfsi_inside"><div class="icon2"><div class="fb-like" data-href="https://blog.kroy.io/2018/07/16/building-a-zfs-on-linux-fileserver" data-layout="button" data-action="like" data-show-faces="false" data-share="true"></div></div><div class="icon3"><a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fblog.kroy.io%2F2018%2F07%2F16%2Fbuilding-a-zfs-on-linux-fileserver" style="display:inline-block;"> <img class="sfsi_wicon" data-pin-nopin="true" width="auto" height="auto" alt="fb-share-icon" title="Facebook Share" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/visit_icons/fbshare_bck.png"></a></div></div></div></div></div><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="" target="_blank" href="" id="sfsiid_twitter" style="opacity:1"><img data-pin-nopin="true" alt="Twitter" title="Twitter" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/default/default_twitter.png" width="40" height="40" style="" class="sfcm sfsi_wicon " data-effect=""></a><div class="sfsi_tool_tip_2 twt_tool_bdr sfsiTlleft" style="width:59px ;opacity:0;z-index:-1;margin-left:-46px;" id="sfsiid_twitter"><span class="bot_arow bot_twt_arow"></span><div class="sfsi_inside"><div class="icon2"><div class="sf_twiter" style="display: inline-block;vertical-align: middle;width: auto;">
						<a target="_blank" href="https://twitter.com/intent/tweet?text=Hey%2C+check+out+this+cool+site+I+found%3A+www.yourname.com+%23Topic+via%40my_twitter_name+https://blog.kroy.io/2018/07/16/building-a-zfs-on-linux-fileserver" style="display:inline-block">
							<img data-pin-nopin="true" width="auto" class="sfsi_wicon" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/visit_icons/en_US_Tweet.svg" alt="Tweet" title="Tweet"></a>
					</div></div></div></div></div></div><div style="width:40px; height:40px;margin-left:5px;margin-bottom:5px; " class="sfsi_wicons shuffeldiv "><div class="inerCnt"><a class=" sficn" data-effect="" target="_blank" href="" id="sfsiid_linkedin" style="opacity:1"><img data-pin-nopin="true" alt="LinkedIn" title="LinkedIn" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/icons_theme/default/default_linkedin.png" width="40" height="40" style="" class="sfcm sfsi_wicon " data-effect=""></a><div class="sfsi_tool_tip_2 linkedin_tool_bdr sfsiTlleft" style="width:85px ;opacity:0;z-index:-1;margin-left:-45px;" id="sfsiid_linkedin"><span class="bot_arow bot_linkedin_arow"></span><div class="sfsi_inside"><div class="icon2"><a target="_blank" href="https://www.linkedin.com/shareArticle?url=https%3A%2F%2Fblog.kroy.io%2F2018%2F07%2F16%2Fbuilding-a-zfs-on-linux-fileserver"><img class="sfsi_wicon" data-pin-nopin="true" alt="Share" title="Share" src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/images/visit_icons/lnkdin_share_bck.png"></a></div></div></div></div></div></div><input type="hidden" id="sfsi_floater_sec" value="center-right"><script>window.addEventListener("sfsi_functions_loaded", function() 
			{
				if (typeof sfsi_widget_set == "function") {
					sfsi_widget_set();
				}
			}); window.addEventListener('sfsi_functions_loaded',function()
					  {
						var topalign = ( jQuery(window).height() - jQuery('#sfsi_floater').height() ) / 2;
						jQuery('#sfsi_floater').css('top',topalign);
					  	sfsi_float_widget('center');
					  });</script><script>
        window.addEventListener('sfsi_functions_loaded', function() {
            if (typeof sfsi_plugin_version == 'function') {
                sfsi_plugin_version(2.60);
            }
        });

        function sfsi_processfurther(ref) {
            var feed_id = 'SERxZVdXbkRiWE9LYThHK2pmY09ydUlMSkF3cm9ERmJpV2JlS3p0Z1locmlNWjBFeGZtaFBCMEF4Q1hRblVqN0JUbGFXRXg4Y25yUnpVcFN0TUVQeTdIVUtkT1JVRXg2SXJvYndWbEJhRi9ZenJWdk1XSlc1VWQwQVIvNVY3dWJ8YnBDU2RZbGZvSzFjVlBLVDRjWGYwellwelNqT2ZCQzFzbmp6V24vN0FQOD0=';
            var feedtype = 8;
            var email = jQuery(ref).find('input[name="email"]').val();
            var filter = /^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
            if ((email != "Enter your email") && (filter.test(email))) {
                if (feedtype == "8") {
                    var url = "https://api.follow.it/subscription-form/" + feed_id + "/" + feedtype;
                    window.open(url, "popupwindow", "scrollbars=yes,width=1080,height=760");
                    return true;
                }
            } else {
                alert("Please enter email address");
                jQuery(ref).find('input[name="email"]').focus();
                return false;
            }
        }
    </script><style type="text/css" aria-selected="true">
        .sfsi_subscribe_Popinner {
            width: 100% !important;

            height: auto !important;

            padding: 18px 0px !important;

            background-color: #ffffff !important;

        }

        .sfsi_subscribe_Popinner form {

            margin: 0 20px !important;

        }

        .sfsi_subscribe_Popinner h5 {

            font-family: Helvetica,Arial,sans-serif !important;

            font-weight: bold !important;

            color: #000000 !important;

            font-size: 16px !important;

            text-align: center !important;

            margin: 0 0 10px !important;

            padding: 0 !important;

        }

        .sfsi_subscription_form_field {

            margin: 5px 0 !important;

            width: 100% !important;

            display: inline-flex;

            display: -webkit-inline-flex;

        }

        .sfsi_subscription_form_field input {

            width: 100% !important;

            padding: 10px 0px !important;

        }

        .sfsi_subscribe_Popinner input[type=email] {

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color: #000000 !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]::-webkit-input-placeholder {

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color: #000000 !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]:-moz-placeholder {
            /* Firefox 18- */

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color: #000000 !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]::-moz-placeholder {
            /* Firefox 19+ */

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color: #000000 !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=email]:-ms-input-placeholder {

            font-family: Helvetica,Arial,sans-serif !important;

            font-style: normal !important;

            color: #000000 !important;

            font-size: 14px !important;

            text-align: center !important;

        }

        .sfsi_subscribe_Popinner input[type=submit] {

            font-family: Helvetica,Arial,sans-serif !important;

            font-weight: bold !important;

            color: #000000 !important;

            font-size: 16px !important;

            text-align: center !important;

            background-color: #dedede !important;

        }

        .sfsi_shortcode_container {
            float: left;
        }

        .sfsi_shortcode_container .norm_row .sfsi_wDiv {
            position: relative !important;
        }

        .sfsi_shortcode_container .sfsi_holders {
            display: none;
        }

            </style><script src="https://blog.kroy.io/wp-includes/js/jquery/ui/core.min.js" id="jquery-ui-core-js"></script><script src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/js/shuffle/modernizr.custom.min.js" id="SFSIjqueryModernizr-js"></script><script src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/js/shuffle/jquery.shuffle.min.js" id="SFSIjqueryShuffle-js"></script><script src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/js/shuffle/random-shuffle-min.js" id="SFSIjqueryrandom-shuffle-js"></script><script id="SFSICustomJs-js-extra">
var sfsi_icon_ajax_object = {"ajax_url":"https:\/\/blog.kroy.io\/wp-admin\/admin-ajax.php"};
var sfsi_icon_ajax_object = {"ajax_url":"https:\/\/blog.kroy.io\/wp-admin\/admin-ajax.php","plugin_url":"https:\/\/blog.kroy.io\/wp-content\/plugins\/ultimate-social-media-icons\/"};
</script><script src="https://blog.kroy.io/wp-content/plugins/ultimate-social-media-icons/js/custom.js" id="SFSICustomJs-js"></script><script src="https://blog.kroy.io/wp-content/plugins/wplegalpages/admin/js/jquery.cookie.min.js" id="wp-legal-pages-jquery-cookie-js"></script><script id="sinatra-js-js-extra">
var sinatra_vars = {"ajaxurl":"https:\/\/blog.kroy.io\/wp-admin\/admin-ajax.php","nonce":"00b8b3d7c4","responsive-breakpoint":"960","sticky-header":"","strings":{"comments_toggle_show":"Leave a Comment","comments_toggle_hide":"Hide Comments"}};
</script><script src="https://blog.kroy.io/wp-content/themes/sinatra/assets/js/sinatra.min.js" id="sinatra-js-js"></script><script>
	!function(){var e=-1<navigator.userAgent.toLowerCase().indexOf("webkit"),t=-1<navigator.userAgent.toLowerCase().indexOf("opera"),n=-1<navigator.userAgent.toLowerCase().indexOf("msie");(e||t||n)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",function(){var e,t=location.hash.substring(1);/^[A-z0-9_-]+$/.test(t)&&(e=document.getElementById(t))&&(/^(?:a|select|input|button|textarea)$/i.test(e.tagName)||(e.tabIndex=-1),e.focus())},!1)}();
	</script><script type="text/javascript" src="https://stats.wp.com/e-202045.js" async="async" defer></script><script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:9.0.2',blog:'166765678',post:'30',tz:'-6',srv:'blog.kroy.io'} ]);
	_stq.push([ 'clickTrackerInit', '166765678', '30' ]);
</script><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="display:none"><symbol id="icon-chat" viewbox="0 0 576 512"><path d="M512 160h-96V64c0-35.3-28.7-64-64-64H64C28.7 0 0 28.7 0 64v160c0 35.3 28.7 64 64 64h32v52c0 7.1 5.8 12 12 12 2.4 0 4.9-.7 7.1-2.4L224 288h128c35.3 0 64-28.7 64-64v-32h96c17.6 0 32 14.4 32 32v160c0 17.6-14.4 32-32 32h-64v49.6l-80.2-45.4-7.3-4.2H256c-17.6 0-32-14.4-32-32v-96l-32 18.1V384c0 35.3 28.7 64 64 64h96l108.9 61.6c2.2 1.6 4.7 2.4 7.1 2.4 6.2 0 12-4.9 12-12v-52h32c35.3 0 64-28.7 64-64V224c0-35.3-28.7-64-64-64zm-128 64c0 17.6-14.4 32-32 32H215.6l-7.3 4.2-80.3 45.4V256H64c-17.6 0-32-14.4-32-32V64c0-17.6 14.4-32 32-32h288c17.6 0 32 14.4 32 32v160z"></path></symbol><symbol id="icon-quote" viewbox="0 0 123.961 123.961"><path d="M49.8 29.032c3.1-1.3 4.4-5 3-8l-4.9-10.3c-1.4-2.899-4.8-4.2-7.8-2.899-8.5 3.6-15.8 8.3-21.6 14C11.4 28.532 6.6 36.232 4 44.732c-2.6 8.601-4 20.3-4 35.2v30.7c0 3.3 2.7 6 6 6h39.3c3.3 0 6-2.7 6-6v-39.3c0-3.301-2.7-6-6-6H26.5c.2-10.101 2.6-18.2 7-24.301 3.6-4.898 9-8.898 16.3-11.999zM120.4 29.032c3.1-1.3 4.399-5 3-8l-4.9-10.199c-1.4-2.9-4.8-4.2-7.8-2.9-8.4 3.6-15.601 8.3-21.5 13.9-7.101 6.8-12 14.5-14.601 23-2.6 8.399-3.899 20.1-3.899 35.1v30.7c0 3.3 2.7 6 6 6H116c3.3 0 6-2.7 6-6v-39.3c0-3.301-2.7-6-6-6H97.1c.2-10.101 2.601-18.2 7-24.301 3.6-4.899 9-8.899 16.3-12z"></path></symbol></svg><div class="wpautoterms-footer"><p>
		<a href="https://blog.kroy.io/wpautoterms/privacy-policy/">Privacy Policy</a><span class="separator"> - </span><a href="https://blog.kroy.io/wpautoterms/terms-and-conditions/">Terms and Conditions</a></p>
</div>
</body></html>
